(function(){"use strict";var e=this,t=e.screen,n=e.document,i=e.navigator.userAgent.indexOf("Mac OS X")!=-1,o=false,r=["keydown","keypress","keyup","click","dblclick","wheel","contextmenu","compositionstart","compositionupdate","compositionend","cut","copy","paste","select"],s=["pointerdown","pointerup"],f=["mousedown","mouseup","touchstart","touchend"],l=false,a=[],c,u=function(e){return e},p=Object.prototype.toString,d=function(e){var t="";if(e.name){t+=" "+e.name}else if(e.id){t+=" "+e.id}else if(e.nodeName){t+=" "+e.nodeName}return"[HI"+t+"]"},g=function(e){if(typeof e==="string"){var t=n.querySelector(e);return t}return e},h=function(e){if(w.isString(e)){return[e]}return e},m=function(e,t){if(t.indexOf(false)!==-1){e.preventDefault()}},v=function(e){var t,n;if(w.isArray(e)){t=e.slice(0);for(n=0;n<t.length;n++){t[n]=v(t[n])}return t}else{return e}},S=function(e,t){var n=[],i,o,r;if(e.length===1){return e[0]}else{i=S(e.slice(1),t);for(o=0;o<i.length;o++){for(r=0;r<e[0].length;r++){n.push(e[0][r]+t+i[o])}}return n}},_=function(e,t){return/touch/.test(e.type)?(e.originalEvent||e).changedTouches[0]["page"+t]:e["page"+t]},y=function(e){if(e==e.toUpperCase()&&e!=e.toLowerCase()){return true}},w=w||u;["Function","String","Number"].forEach(function(e){w["is"+e]=function(t){return p.call(t)=="[object "+e+"]"}});w.isArray=Array.isArray;w.toArray=function(e){var t,n=[];for(t=e.length>>>0;t--;){n[t]=e[t]}return n};w.partial=function(e){var t=w.toArray(arguments).slice(1);return function(){return e.apply(this,t.concat(w.toArray(arguments)))}};w.isEqual=function(e,t){return e&&t&&typeof e==="object"&&typeof t==="object"?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(function(n,i){return n&&w.isEqual(e[i],t[i])},true):e===t};if(Object.keys(e.KeyboardEvent.prototype).indexOf("key")!==-1){o=true}var E=function(t,i){if(!(this instanceof E)){return new E(t,i)}var r=this,s,f,p,O,b,k,L,x,A=0;r.VERSION="1.0.9";r.OSKEYS=["OS","OSLeft","OSRight"],r.CONTROLKEYS=["Control","ControlLeft","ControlRight"],r.ALTKEYS=["Alt","AltLeft","AltRight"],r.SHIFTKEYS=["Shift","ShiftLeft","ShiftRight","⇧"],r.ALLMODIFIERS=r.OSKEYS.concat(r.CONTROLKEYS,r.ALTKEYS,r.SHIFTKEYS),r.MODPRIORITY={};r.ControlKeyEvent="ctrl";r.ShiftKeyEvent="shift";r.AltKeyEvent="alt";r.OSKeyEvent="os";r.AltAltNames=["option","⌥"];r.AltOSNames=["meta","win","⌘","cmd","command"];i=i||{};r.l=i.translate||u;i.listenEvents=i.listenEvents||E.defaultListenEvents;i.eventOptions=i.eventOptions||{};i.noKeyRepeat=i.noKeyRepeat||true;i.sequenceTimeout=i.sequenceTimeout||3e3;i.maxSequenceBuf=i.maxSequenceBuf||12;i.uniqueNumpad=i.uniqueNumpad||false;i.swipeThreshold=i.swipeThreshold||100;i.disableSequences=i.disableSequences||false;i.disableSelectors=i.disableSelectors||false;r.settings=i;r.elem=g(t||e);r.log=new r.logger(i.logLevel||"INFO",d(t));k=r.CONTROLKEYS.concat(["ctrl"]);L=r.ALTKEYS.concat(r.AltAltNames);x=r.OSKEYS.concat(r.AltOSNames);for(s=0;s<k.length;s++){r.MODPRIORITY[k[s].toLowerCase()]=5}for(s=0;s<r.SHIFTKEYS.length;s++){r.MODPRIORITY[r.SHIFTKEYS[s].toLowerCase()]=4}for(s=0;s<L.length;s++){r.MODPRIORITY[L[s].toLowerCase()]=3}for(s=0;s<x.length;s++){r.MODPRIORITY[x[s].toLowerCase()]=2}r._resetKeyStates=function(){r.modifiers={};r.seqBuffer=[];r.down=[];a=[];A=0;l=false};r._addDown=function(e,t){var n=r.down.indexOf(e);if(n===-1){n=a.indexOf(e)}if(n===-1&&t){n=a.indexOf(t)}if(n===-1){r.down.push(e);if(t){a.push(t)}else{a.push(e)}}};r._removeDown=function(e){var t=r.down.indexOf(e);if(t===-1){t=a.indexOf(e)}if(t===-1){t=a.indexOf(e.toUpperCase())}if(t!==-1){r.down.splice(t,1);a.splice(t,1)}A=r.down.length};r._doDownEvent=function(e){var t,n=w.toArray(arguments).slice(1);r._addDown(e);t=r._handleDownEvents.apply(r,n);r._handleSeqEvents();r._removeDown(e);return t};r._resetSeqTimeout=function(){clearTimeout(c);c=setTimeout(function(){r.log.debug(r.l("Resetting key states due to timeout"));r._resetKeyStates()},r.settings.sequenceTimeout)};r._genericEvent=function(e,t){var n=r.filter(t),i;if(n){if(e.type){t=e;e=null}if(e){e=e+":"}else{e=""}i=r.trigger(r.scope+e+t.type,t);if(t.target){i=i.concat(r._handleSelectors(e+t.type,t))}m(t,i)}};r._handleSelectors=function(e){var t=[],n=w.toArray(arguments).slice(1),i=r,o;if(n[0]&&n[0].target){i=n[0].target;if(i.id){o=e+":#"+i.id;t=r.trigger.apply(i,[o].concat(n))}if(i.classList&&i.classList.length){for(var s=0;s<i.classList.length;s++){o=e+":."+i.classList.item(s);t=t.concat(r.trigger.apply(i,[o].concat(n)))}}}return t};r._triggerWithSelectors=function(e,t){var n=[],i=r.scope+e;n=n.concat(r.trigger.apply(r,[i].concat(t)));n=n.concat(r._handleSelectors.apply(r,[i].concat(t)));return n};r._keyEvent=function(e){if(r.CONTROLKEYS.indexOf(e)!=-1){return r.ControlKeyEvent}else if(r.ALTKEYS.indexOf(e)!=-1){return r.AltKeyEvent}else if(r.SHIFTKEYS.indexOf(e)!=-1){return r.ShiftKeyEvent}else if(r.OSKEYS.indexOf(e)!=-1){return r.OSKeyEvent}else{return e.toLowerCase()}};r._seqCombinations=function(e,t){t=t||"-";var n=v(e),i=[],o=[],s,f;for(s=0;s<e.length;s++){i.push(n[s].join(t).toLowerCase())}i=[i.join(" ")];for(s=0;s<e.length;s++){for(f=0;f<e[s].length;f++){n[s][f]=[r._keyEvent(e[s][f])]}}for(s=0;s<n.length;s++){o.push(S(n[s],t))}o=o.join(" ");if(o!=i[0]){i.push(o)}return i};r._handledShifted=function(e){var t,n=-1;if(r.modifiers.shift){for(s=0;s<e.length;s++){n=e[s].indexOf("Shift");if(n!==-1){break}}}if(n!==-1){for(s=0;s<e.length;s++){if(e[s]!=a[s]){t=true}}}if(t){e.splice(n,1);return true}};r._downEvents=function(){var e=[],t,n=r.down.slice(0),i=n.length,o=a.slice(0);if(i){if(i>1){t=r._handledShifted(n);if(!(i===2&&t)){e=e.concat(r._seqCombinations([n],"->"));if(t){e=e.concat(r._seqCombinations([o],"->"))}}}r._sortEvents(n);e=e.concat(r._seqCombinations([n]));if(t){r._sortEvents(o);e=e.concat(r._seqCombinations([o]))}}return e};r._handleDownEvents=function(){var e,t,n,i=w.toArray(arguments);t=r._downEvents();for(e=0;e<t.length;e++){n=r._triggerWithSelectors(t[e],i)}return n};r._handleSeqEvents=function(){var e,t,n,i,o,s=r.down.slice(0);if(A<s.length){s=r._sortEvents(s);r._handledShifted(s);r.seqBuffer.push(s);if(r.seqBuffer.length>r.settings.maxSequenceBuf){r.seqBuffer.shift()}if(r.seqBuffer.length>1){e=r._seqCombinations(r.seqBuffer);for(t=0;t<e.length;t++){o=r._seqSlicer(e[t]);for(n=0;n<o.length;n++){i=r.trigger(r.scope+o[n],r)}}if(i.length){r.seqBuffer=[]}}}r._resetSeqTimeout()};r._normSpecial=function(e,t,n){if(t==" "){return n}if(n.indexOf("Left")!==-1||n.indexOf("Right")!==-1){t=n}else if(r.settings.uniqueNumpad&&e===3){return"numpad"+t}if(t.indexOf("Arrow")===0){t=t.substr(5)}return t};r._setModifiers=function(e,t){if(r.ALLMODIFIERS.indexOf(e)){if(r.SHIFTKEYS.indexOf(e)!==-1){r.modifiers.shift=t}if(r.CONTROLKEYS.indexOf(e)!==-1){r.modifiers.ctrl=t}if(r.ALTKEYS.indexOf(e)!==-1){r.modifiers.alt=t;r.modifiers.option=t;r.modifiers["⌥"]=t}if(r.OSKEYS.indexOf(e)!==-1){r.modifiers.meta=t;r.modifiers.command=t;r.modifiers.os=t;r.modifiers["⌘"]=t}r.modifiers[e]=t}};r._keydown=function(e){var t,n=e.which||e.keyCode,i=e.location||0,s=r.keyMaps[i][n]||r.keyMaps[0][n]||e.code,f=e.key||s,l=e.type,c=r.scope+"faceplant",u=r.filter(e);f=r._normSpecial(i,f,s);r._setModifiers(f,true);if(f=="Compose"){r.state.composing=true;return}if(a.indexOf(f)===-1){r._addDown(f,s)}r._resetSeqTimeout();if(u){if(e.repeat&&r.settings.noKeyRepeat){e.preventDefault();return false}t=r._triggerWithSelectors(l,[e,f,s]);t=t.concat(r._triggerWithSelectors(l+=":"+f.toLowerCase(),[e,f,s]));if(r.down.length>5){t=t.concat(r.trigger(c,e))}if(o){t=t.concat(r._handleDownEvents(e,f,s))}m(e,t)}};r._keypress=function(e){var t=e.charCode||e.which,n=e.key||String.fromCharCode(t);if(!o&&t>47&&n.length){r.down.pop();r.down.push(n)}};r._keyup=function(e){var t,n=e.which||e.keyCode,i=e.location||0,s=r.keyMaps[i][n]||r.keyMaps[0][n]||e.code,f=e.key||s,l=e.type,c=r.filter(e);f=r._normSpecial(i,f,s);if(!a.length){return}if(r.state.composing){r.state.composing=false;return}if(c){if(!o){r._handleDownEvents(e)}t=r._triggerWithSelectors(l,[e,f,s]);t=t.concat(r._triggerWithSelectors(l+":"+f.toLowerCase(),[e,f,s]));r._handleSeqEvents();m(e,t)}r._removeDown(f);r._setModifiers(s,false)};r._pointerdown=function(e){var t,n,i=r.mouse(e),o,s=e.changedTouches,l=e.pointerType,a="pointer",c=":down",u=r.filter(e);if(e.type=="mousedown"&&b){return}if(l){if(l=="touch"){n=e.pointerId;if(!r.touches[n]){r.touches[n]=e}}}else if(s&&s.length){for(t=0;t<s.length;t++){n=s[t].identifier;if(!r.touches[n]){r.touches[n]=s[t]}}}f=_(e,"X");p=_(e,"Y");r._resetSeqTimeout();if(u){o=r._triggerWithSelectors(a+c,[e]);if(i.buttonName!==undefined){a+=":"+i.buttonName;o=o.concat(r._triggerWithSelectors(a+c,[e]))}m(e,o)}r._addDown(a);r._handleDownEvents(e)};r._mousedown=r._pointerdown;r._touchstart=r._pointerdown;r._pointerup=function(e){var t,n,i,o,s,l,a,c=e.changedTouches,u=e.pointerType,d=r.settings.swipeThreshold,g,h=":up",v="pointer";if(u){if(u=="touch"){n=e.pointerId;if(r.touches[n]){f=r.touches[n].pageX;p=r.touches[n].pageY;s=e.pageX-f;l=e.pageY-p;delete r.touches[n]}}}else if(c){if(c.length){for(t=0;t<c.length;t++){n=c[t].identifier;if(r.touches[n]){f=r.touches[n].pageX;p=r.touches[n].pageY;s=e.pageX-f;l=e.pageY-p;delete r.touches[n]}}}if(Math.abs(e.pageX-f)<20&&Math.abs(e.pageY-p)<20){b=true}if(e.pageX==f&&e.pageY==p){o=true}}if(b&&e.type=="mouseup"){b=false;return}r._resetSeqTimeout();if(r.filter(e)){g=r._triggerWithSelectors(v+h,[e]);i=r.mouse(e);if(i.buttonName!==undefined){v+=":"+i.buttonName;g=g.concat(r._triggerWithSelectors(v+h,[e]))}s=f-_(e,"X");l=p-_(e,"Y");a="swipe";if(Math.abs(s)>Math.abs(l)){if(s>d){a+=":left"}else if(s<-d){a+=":right"}}else{if(l>d){a+=":up"}else if(l<-d){a+=":down"}}if(a!="swipe"){r._removeDown(v);r._addDown(a);g=g.concat(r._handleDownEvents(e));g=g.concat(r._handleSelectors(a,e));r._handleSeqEvents();r._removeDown(a)}else{r._handleSeqEvents();r._removeDown(v);if(o){g=g.concat(r._triggerWithSelectors("click",[e]))}m(e,g)}}f=null;p=null};r._mouseup=r._pointerup;r._touchend=r._pointerup;r._click=function(e){var t=[],n=r.mouse(e),i=e.type,o=r.filter(e);r._resetSeqTimeout();if(o){if(n.left){t=t.concat(r._triggerWithSelectors(i,[e]))}t=t.concat(r._triggerWithSelectors(i+":"+n.buttonName,[e]));m(e,t)}};r._tap=r._click;r._dblclick=r._click;r._wheel=function(e){var t,n=r.filter(e),i="wheel";r._resetSeqTimeout();if(n){t=r._triggerWithSelectors(i,[e]);if(e.deltaY>0){t=t.concat(r._doDownEvent(i+":down",e))}else if(e.deltaY<0){t=t.concat(r._doDownEvent(i+":up",e))}if(e.deltaZ>0){t=t.concat(r._doDownEvent(i+":out",e))}else if(e.deltaZ<0){t=t.concat(r._doDownEvent(i+":in",e))}if(e.deltaX>0){t=t.concat(r._doDownEvent(i+":right",e));if(r.isDown("shift")){t=t.concat(r._triggerWithSelectors(i+":right",[e]))}}else if(e.deltaX<0){t=t.concat(r._doDownEvent(i+":left",e));if(r.isDown("shift")){t=t.concat(r._triggerWithSelectors(i+":left",[e]))}}m(e,t)}};r._contextmenu=function(e){var t,n=r.filter(e),i="contextmenu";r._resetSeqTimeout();if(n){t=r._triggerWithSelectors(i,[e]);m(e,t)}};r._composition=function(e){var t,n=r.filter(e),i=e.data,o="compos";if(n){t=r._triggerWithSelectors(e.type,[e,i]);if(i){if(e.type=="compositionupdate"){o+='ing:"'+i+'"'}else if(e.type=="compositionend"){o+='ed:"'+i+'"'}t=t.concat(r._triggerWithSelectors(o,[e]));m(e,t)}}};r._compositionstart=r._composition;r._compositionupdate=r._composition;r._compositionend=r._composition;r._clipboard=function(t){var n,i,o=r.filter(t),s=t.type+':"';if(o){if(e.clipboardData){n=e.clipboardData.getData("Text")}else if(t.clipboardData){n=t.clipboardData.getData("text/plain")}if(!n&&(t.type=="copy"||t.type=="cut")){n=r.getSelText()}if(n){i=r._triggerWithSelectors(t.type,[t,n]);i=i.concat(r._triggerWithSelectors(s+n+'"',[t]));m(t,i)}}};r._paste=r._clipboard;r._copy=r._clipboard;r._cut=r._clipboard;r._select=function(e){var t,n=r.getSelText(),i=r.filter(e),o=e.type+':"';if(i){t=r._triggerWithSelectors(e.type,[e,n]);if(n){t=t.concat(r._triggerWithSelectors(o+n+'"',[e]));m(e,t)}}};r.filter=function(e){var t=(e.target||e.srcElement).tagName,n=["keydown","keyup","keypress"];if(n.indexOf(e.type)!=-1){return!(t=="INPUT"||t=="SELECT"||t=="TEXTAREA")}return true};r.startRecording=function(){r.recording=true;O=[]};r.stopRecording=function(e){var t,n,i,o=new RegExp(e),s=function(e){return e.indexOf(":#")===-1&&e.indexOf(":.")===-1};r.recording=false;if(!e){return O}if(e=="keystroke"){i=O.filter(s);o=new RegExp("keyup");for(var f=0;f<i.length;f++){if(o.test(i[f])){break}n=i[f]}return n}t=O.filter(function(e){return o.test(e)});return t};r.isDown=function(e){var t,n,i,o=r._downEvents();e=e.toLowerCase();if(o.indexOf(e)!==-1){return true}for(t=0;t<r.down.length;t++){n=r.down[t].toLowerCase();i=a[t].toLowerCase();if(e==n||e==i){return true}else if(r.SHIFTKEYS.indexOf(r.down[t])!==-1){if(e==r.ShiftKeyEvent){return true}}else if(r.CONTROLKEYS.indexOf(r.down[t])!==-1){if(e==r.ControlKeyEvent){return true}}else if(r.ALTKEYS.indexOf(r.down[t])!==-1){if(e==r.AltKeyEvent){return true}}else if(r.OSKEYS.indexOf(r.down[t])!==-1){if(e==r.OSKeyEvent){return true}}}return false};r.getSelText=function(){var t="";if(e.getSelection){t=e.getSelection()}else if(n.selection){t=n.selection.createRange().text}else{return}return t.toString()};r._handleAliases=function(e){e=r.aliases[e]||e;if(e.length===1&&y(e)){e="shift-"+e}return e};r.on=function(e,t,n,i){h(e).forEach(function(e){var o,s,f,l;if(e.indexOf(":")!==-1){l=":"}else if(e.indexOf(" ")!==-1){l=" "}if(l){s=new RegExp(l+'(?=(?:(?:[^"]*"){2})*[^"]*$)',"g");f=e.split(s);e="";for(o=0;o<f.length;o++){e+=r._handleAliases(f[o])+l}e=e.replace(new RegExp(l+"+$"),"")}else{e=r._handleAliases(e)}e=e.toLowerCase();if(e.indexOf("-")!==-1){if(e.indexOf("->")===-1){e=r._normCombo(e)}}if(!n){n={}}var a=r.events[e],c={callback:t,context:n,times:i};if(!a){a=r.events[e]=[]}a.push(c)});return r};r.once=function(e,t,n){return r.on(e,t,n,1)};r.off=function(e,t,n){var i,o;if(!arguments.length){r.events={}}else{e=e?h(e):Object.keys(r.events);for(i in e){var s=e[i],f=r.events[s];if(f){var l=[];if(!n){if(!t){delete r.events[s];break}}for(o=0;o<f.length;o++){if(t){if(f[o].callback.toString()==t.toString()){if((n===null||n===undefined)&&f[o].context){l.push(f[o])}else if(!w.isEqual(f[o].context,n)){l.push(f[o])}}else{l.push(f[o])}}else if(n&&f[o].context!==n){l.push(f[o])}}if(!l.length){delete r.events[s]}else{r.events[s]=l}}}}return r};r.trigger=function(t){var n,i,o,s=[],f=w.toArray(arguments).slice(1);h(t).forEach(function(t){t=r.aliases[t]||t;r.log.debug("Triggering:",t,f.length?f:"");if(r.recording){O.push(t)}i=r.events[t];if(i){for(n=0;n<i.length;n++){o=i[n];if(o.context!==e){o.context.HIEvent=t}if(o.times){o.times-=1;if(o.times===0){r.off(t,o.callback,o.context)}}s.push(o.callback.apply(o.context||this,f))}}});return s};r.emit=r.trigger;if(typeof n.hidden!=="undefined"){n.addEventListener("visibilitychange",function(e){if(n.hidden){r.trigger("document:hidden",e)}else{r.trigger("document:visible",e)}},false)}if(r.elem===e){["resize","beforeunload","hashchange","languagechange"].forEach(function(t){e.addEventListener(t,r._genericEvent.bind(r,"window"),true)});if(e.orientation!==undefined){e.addEventListener("orientationchange",function(t){var n="window:orientation";r.trigger(n,t);if(Math.abs(e.orientation)===90){r.trigger(n+":landscape",t)}else{r.trigger(n+":portrait",t)}},false)}}r.init(r)};E.plugins=[];if(e.PointerEvent){E.defaultListenEvents=r.concat(s)}else{E.defaultListenEvents=r.concat(f)}E.noop=u;E.prototype.init=function(n){var o,r,s,f;n=n||this;if(n.events){n.trigger("hi:reset")}n.scope="";n.down=[];n.modifiers={};n.seqBuffer=[];n.touches={};n.state={};n.aliases={tap:"click",middleclick:"pointer:middle",rightclick:"pointer:right",doubleclick:"dblclick",tripleclick:Array(4).join("pointer:left ").trim(),quadrupleclick:Array(5).join("pointer:left ").trim(),konami:"up up down down left right left right b a enter",portrait:"window:orientation:portrait",landscape:"window:orientation:landscape",hulksmash:"faceplant"};n.events={};l=false;a=[];c=null;if(n.settings.disableSequences){n._handleSeqEvents=u}if(n.settings.disableSelectors){n._handleSelectors=u}if(n.elem===e){n.on("window:resize",function(){if(e.outerWidth===t.width&&e.outerHeight===t.height){n.state.fullscreen=true;n.trigger("fullscreen",true)}else if(n.state.fullscreen){n.state.fullscreen=false;n.trigger("fullscreen",false)}})}n.off("hi:pause");n.on("hi:pause",function(){n.log.debug(n.l("Pause: Removing event listeners"));n.settings.listenEvents.forEach(function(e){var t=n.settings.eventOptions[e]||true;if(w.isFunction(n["_"+e])){n.elem.removeEventListener(e,n["_"+e],t)}})});n.off(["hi:initialized","hi:resume"]);n.on(["hi:initialized","hi:resume"],function(){n.log.debug("HumanInput Version: "+n.VERSION);n.log.debug(n.l("Start/Resume: Addding event listeners"),n.settings.listenEvents);n.settings.listenEvents.forEach(function(e){var t=n.settings.eventOptions[e]||true;if(w.isFunction(n["_"+e])){n.elem.removeEventListener(e,n["_"+e],t);n.elem.addEventListener(e,n["_"+e],t)}else{n["_"+e]=n._genericEvent.bind(n,n.elem.name);n.elem.addEventListener(e,n["_"+e],t)}})});n.keyMaps={0:{Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,Pause:19,CapsLock:20,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,Left:37,ArrowUp:38,Up:38,ArrowRight:39,Right:39,ArrowDown:40,Down:40,PrintScreen:42,Insert:45,Delete:46,Semicolon:59,"=":61,OS:92,Select:93,NumLock:144,ScrollLock:145,VolumeDown:174,VolumeUp:175,MediaTrackPrevious:177,MediaPlayPause:179,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222,AltGraph:225,Compose:229},1:{ShiftLeft:16,ControlLeft:17,AltLeft:18,OSLeft:91},2:{ShiftRight:16,ControlRight:17,AltRight:18,OSRight:92}};if(n.settings.uniqueNumpad){n.keyMaps[3]={NumpadMultiply:106,NumpadAdd:107,NumpadSubtract:109,NumpadDecimal:46,Slash:111}}else{n.keyMaps[3]={"*":106,"+":107,"-":109,".":46,"/":111}}for(o=48;o<=57;o++){n.keyMaps[0][o]=""+(o-48)}for(o=65;o<=90;o++){n.keyMaps[0][o]=String.fromCharCode(o)}for(o=96;o<=105;o++){n.keyMaps[3][o]="Numpad"+(o-96)}for(o=112;o<=123;o++){n.keyMaps[0][o]="F"+(o-112+1)}if(i){var p={3:"Enter",63289:"NumpadClear",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"ArrowLeft",63232:"ArrowUp",63235:"ArrowRight",63233:"ArrowDown",63302:"Insert",63272:"Delete"};for(f in p){n.keyMaps[0][f]=p[f]}for(o=63236;o<=63242;o++){n.keyMaps[0][o]="F"+(o-63236+1)}}for(o=0;o<=3;o++){Object.keys(n.keyMaps[o]).forEach(function(e){if(e.length>1&&!isNaN(e)){e=parseInt(e)}n.keyMaps[o][n.keyMaps[o][e]]=e})}if(E.plugins.length){for(o=0;o<E.plugins.length;o++){r=new E.plugins[o](n);n.log.debug(n.l("Initializing Plugin:"),r.__name__);if(w.isFunction(r.init)){s=r.init(n);for(f in s.exports){n[f]=s.exports[f]}}}}n.trigger("hi:initialized",n)};E.prototype.logger=function(t,n){var i=this,o=function(t){var o=w.toArray(arguments);o[0]=n+i.levels[t]+" "+o[0];if(w.isFunction(e.console.log)){e.console.log.apply(e.console,o)}},r=o,s=o,f=o,l=o,a=function(t){var o=Array.prototype.slice.call(arguments,1);if(n.length){o.unshift(n)}if(t===40&&i.logLevel<=40){r.apply(e.console,o)}else if(t===30&&i.logLevel<=30){s.apply(e.console,o)}else if(t===20&&i.logLevel<=20){f.apply(e.console,o)}else if(t===10&&i.logLevel<=10){l.apply(e.console,o)}};n=n||"";i.levels={40:"ERROR",30:"WARNING",20:"INFO",10:"DEBUG",ERROR:40,WARNING:30,INFO:20,DEBUG:10};if(w.isFunction(e.console.error)){r=e.console.error}if(w.isFunction(e.console.warn)){s=e.console.warn}if(w.isFunction(e.console.info)){f=e.console.info}if(w.isFunction(e.console.debug)){l=e.console.debug}i.setLevel=function(e){e=e.toUpperCase();i.error=w.partial(a,40);i.warn=w.partial(a,30);i.info=w.partial(a,20);i.debug=w.partial(a,10);i.logLevel=e;if(isNaN(e)){i.logLevel=e=i.levels[e]}if(e>40){i.error=u}if(e>30){i.warn=u}if(e>20){i.info=u}if(e>10){i.debug=u}};i.setLevel(t)};E.prototype.pushScope=function(e){if(this.scope.length){this.scope=this.scope.slice(0,-1)+"."+e+":"}else{this.scope=e+":"}};E.prototype.popScope=function(){if(this.scope.length){this.scope=this.scope.slice(0,-1).split(".").slice(0,-1).join(".")+":"}if(this.scope==":"){this.scope=""}};E.prototype.pause=function(){this.state.paused=true;this.trigger("hi:pause",this)};E.prototype.resume=function(){this.state.paused=false;this.trigger("hi:resume",this)};E.prototype._seqSlicer=function(e){var t=[],n,i,o;e=e.split(/ +(?=(?:(?:[^"]*"){2})*[^"]*$)/g);for(n=0;n<e.length-1;n++){i=e.slice(n);o=i.join(" ");if(t.indexOf(o)===-1){t.push(o)}}return t};E.prototype._sortEvents=function(e){var t=this.MODPRIORITY;e.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())});e.sort(function(e,t){return t.length-e.length});e.sort(function(e,n){e=e.toLowerCase();n=n.toLowerCase();if(e in t){if(n in t){if(t[e]>t[n]){return-1}else if(t[e]<t[n]){return 1}else{return 0}}return-1}else if(n in t){return 1}else{return 0}});return e};E.prototype._normCombo=function(e){var t=this,n,i=e.split("-"),o=function(e){if(e=="control"){return t.ControlKeyEvent}return e},r=function(e){for(var n=0;n<t.AltAltNames.length;n++){if(e==t.AltAltNames[n]){return t.AltKeyEvent}}return e},s=function(e){for(var n=0;n<t.AltOSNames.length;n++){if(e==t.AltOSNames[n]){return t.OSKeyEvent}}return e};for(n=0;n<i.length;n++){i[n]=i[n].toLowerCase();i[n]=o(i[n]);i[n]=r(i[n]);i[n]=s(i[n])}t._sortEvents(i);return i.join("-")};E.prototype.mouse=function(e){var t={type:e.type};if(e.type!="mousemove"&&e.type!="wheel"){if(e.button===0){t.left=true;t.buttonName="left"}else if(e.button===1){t.middle=true;t.buttonName="middle"}else if(e.button===2){t.right=true;t.buttonName="right"}else if(e.button===3){t.back=true;t.buttonName="back"}else if(e.button===4){t.forward=true;t.buttonName="forward"}else if(e.button===5){t.forward=true;t.buttonName="eraser"}else{t.buttonName=e.button}}t.button=e.button;return t};if(typeof module!=="undefined"&&module.exports){module.exports=E}if(typeof define==="function"&&define.amd){define([],function(){return E})}else if(typeof exports!=="undefined"&&exports!==null){exports.HumanInput=E}else{e.HumanInput=E}}).call(this);
