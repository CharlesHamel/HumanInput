(function(){"use strict";var e=this,t,n=navigator.userAgent.indexOf("Mac OS X")!=-1,o=false,i=["keydown","keypress","keyup","click","dblclick","wheel","contextmenu","compositionstart","compositionupdate","compositionend","cut","copy","paste","select"],r=["pointerdown","pointerup"],s=["mousedown","mouseup","touchstart","touchend"],a=false,l=[],c,f=function(e){return e},u=Object.prototype.toString,p=function(e){var t="";if(e.name){t+=" "+e.name}else if(e.id){t+=" "+e.id}else if(e.nodeName){t+=" "+e.nodeName}return"[HI"+t+"]"},g=function(e){if(typeof e==="string"){var t=document.querySelector(e);return t}return e},d=function(e){if(y.isString(e)){e=[e]}return e},h=function(e,t){if(t.indexOf(false)!=-1){e.preventDefault()}},m=function(e){var t,n;if(y.isArray(e)){t=e.slice(0);for(n=0;n<t.length;n++){t[n]=m(t[n])}return t}else{return e}},v=function(e,t){var n=[],o,i,r;if(e.length==1){return e[0]}else{o=v(e.slice(1),t);for(i=0;i<o.length;i++){for(r=0;r<e[0].length;r++){n.push(e[0][r]+t+o[i])}}return n}},_=function(e,t){return/touch/.test(e.type)?(e.originalEvent||e).changedTouches[0]["page"+t]:e["page"+t]},S=function(e){if(e==e.toUpperCase()){return true}},w=function(e,t){return t!=null&&e!=null&&t.indexOf(e)==0},y=y||f;["Function","String","Number"].forEach(function(e){y["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}});y.isArray=Array.isArray;y.toArray=function(e){var t,n=[];for(t=e.length>>>0;t--;){n[t]=e[t]}return n};y.partial=function(e){var t=y.toArray(arguments);t.shift();return function(){return e.apply(this,t.concat(y.toArray(arguments)))}};if(Object.keys(KeyboardEvent.prototype).indexOf("key")!=-1){o=true}var E=function(n,i){if(!(this instanceof E)){return new E(n,i)}var r=this,s,u,b,x,C=0;r.__version__="1.0.6";r.OSKEYS=["OS","OSLeft","OSRight"],r.CONTROLKEYS=["Control","ControlLeft","ControlRight"],r.ALTKEYS=["Alt","AltLeft","AltRight"],r.SHIFTKEYS=["Shift","ShiftLeft","ShiftRight","⇧"],r.ALLMODIFIERS=r.OSKEYS.concat(r.CONTROLKEYS,r.ALTKEYS,r.SHIFTKEYS),r.ControlKeyEvent="ctrl";r.ShiftKeyEvent="shift";r.AltKeyEvent="alt";r.OSKeyEvent="os";r.AltAltNames=["option","⌥"];r.AltOSNames=["meta","win","⌘","cmd","command"];i=i||{};r.l=t=i.translate||f;i.listenEvents=i.listenEvents||E.defaultListenEvents;i.eventOptions=i.eventOptions||{};i.noKeyRepeat=i.noKeyRepeat||true;i.sequenceTimeout=i.sequenceTimeout||3e3;i.maxSequenceBuf=i.maxSequenceBuf||12;i.uniqueNumpad=i.uniqueNumpad||false;i.swipeThreshold=i.swipeThreshold||100;i.disableSequences=i.disableSequences||false;i.disableSelectors=i.disableSelectors||false;r.settings=i;r.elem=g(n||e);r.log=new r.logger(i.logLevel||"INFO",p(n));r._getInstanceName=function(){for(var t in e){if(e[t]==r)return t}};r._resetKeyStates=function(){r.modifiers={};r.seqBuffer=[];r.down=[];l=[];C=0;a=false};r._addDown=function(e,t){var n=r.down.indexOf(e);if(n==-1){n=l.indexOf(e)}if(n==-1&&t){n=l.indexOf(t)}if(n==-1){r.down.push(e);if(t){l.push(t)}else{l.push(e)}}};r._removeDown=function(e){var t=r.down.indexOf(e);if(t==-1){t=l.indexOf(e)}if(t==-1){t=l.indexOf(e.toUpperCase())}if(t!=-1){r.down.splice(t,1);l.splice(t,1)}C=r.down.length};r._resetSeqTimeout=function(){clearTimeout(c);c=setTimeout(function(){r.log.debug(t("Resetting key states due to timeout"));r._resetKeyStates()},r.settings.sequenceTimeout)};r._genericEvent=function(e,t){var n=r.filter(t);if(n){if(e.type){t=e;e=null}if(e){e=e+":"}else{e=""}r.trigger(r.scope+e+t.type,t);if(t.target){r._handleSelectors(e+t.type,t)}}};r._handleSelectors=function(e){var t=[],n=y.toArray(arguments),o=r;n.shift();if(n[0]&&n[0].target){o=n[0].target;if(o.id){t=r.trigger.apply(o,[r.scope+e+":#"+o.id].concat(n))}if(o.classList.length){for(var i=0;i<o.classList.length;i++){t=t.concat(r.trigger.apply(o,[r.scope+e+":."+o.classList.item(i)].concat(n)))}}}return t};r._keyEvent=function(e){if(r.CONTROLKEYS.indexOf(e)!=-1){return r.ControlKeyEvent}else if(r.ALTKEYS.indexOf(e)!=-1){return r.AltKeyEvent}else if(r.SHIFTKEYS.indexOf(e)!=-1){return r.ShiftKeyEvent}else if(r.OSKEYS.indexOf(e)!=-1){return r.OSKeyEvent}else{return e.toLowerCase()}};r._seqCombinations=function(e,t){t=t||"-";var n=m(e),o=[],i=[],s,a;for(s=0;s<e.length;s++){o.push(n[s].join(t).toLowerCase())}o=[o.join(" ")];for(s=0;s<e.length;s++){for(a=0;a<e[s].length;a++){n[s][a]=[r._keyEvent(e[s][a])]}}for(s=0;s<n.length;s++){i.push(v(n[s],t))}i=i.join(" ");if(i!=o[0]){o.push(i)}return o};r._downEvents=function(){var e,t=[],n,o=-1,i,s=r.down.slice(0),a=l.slice(0);if(s.length){if(s.length>1){if(r.modifiers.shift){for(e=0;e<s.length;e++){o=s[e].indexOf("Shift");if(o!=-1){break}}}for(e=0;e<s.length;e++){if(s[e]!=l[e]&&o!=-1){i=true}}if(i){if(s.length==2){n=true}s.splice(o,1)}if(!n){t=t.concat(r._seqCombinations([s],"->"));if(i){t=t.concat(r._seqCombinations([a],"->"))}}}r._sortEvents(s);t=t.concat(r._seqCombinations([s]));if(i){r._sortEvents(a);t=t.concat(r._seqCombinations([a]))}}return t};r._handleDownEvents=function(){var e,t=[],n=[];t=r._downEvents();for(e=0;e<t.length;e++){n=n.concat(r.trigger.apply(r,[r.scope+t[e]].concat(y.toArray(arguments))));n=n.concat(r._handleSelectors.apply(r,[t[e]].concat(y.toArray(arguments))))}return n};r._handleSeqEvents=function(){var e,t,n,o=r.down.slice(0);if(C<o.length){o=r._sortEvents(o);r.seqBuffer.push(o);if(r.seqBuffer.length>r.settings.maxSequenceBuf){r.seqBuffer.reverse();r.seqBuffer.pop();r.seqBuffer.reverse()}for(t=0;t<r.seqBuffer.length;t++){r.seqBuffer[t].sort(function(e,t){return t.length-e.length})}if(r.seqBuffer.length>1){e=r._seqCombinations(r.seqBuffer);for(var t=0;t<e.length;t++){r._seqSlicer(e[t]).forEach(function(e){n=r.trigger(r.scope+e,r)})}if(n.length){r.seqBuffer=[]}}}r._resetSeqTimeout()};r._normSpecial=function(e,t,n){if(n.indexOf("Left")!=-1||n.indexOf("Right")!=-1){t=n}else if(r.settings.uniqueNumpad&&e==3){return"numpad"+t}if(w("arrow",t.toLowerCase())){t=t.substr(5)}return t};r._setModifiers=function(e,t){if(r.ALLMODIFIERS.indexOf(e)){if(r.SHIFTKEYS.indexOf(e)!=-1){r.modifiers.shift=t}if(r.CONTROLKEYS.indexOf(e)!=-1){r.modifiers.ctrl=t}if(r.ALTKEYS.indexOf(e)!=-1){r.modifiers.alt=t;r.modifiers.option=t;r.modifiers["⌥"]=t}if(r.OSKEYS.indexOf(e)!=-1){r.modifiers.meta=t;r.modifiers.command=t;r.modifiers.os=t;r.modifiers["⌘"]=t}r.modifiers[e]=t}};r._keydown=function(e){var t=[],n=e.which||e.keyCode,i=e.location||0,s=r.keyMaps[i][n]||r.keyMaps[0][n]||e.code,a=e.key||s,c=r.filter(e);a=r._normSpecial(i,a,s);r._setModifiers(a,true);if(a=="Compose"){r.state.composing=true;return}if(l.indexOf(a)==-1){r._addDown(a,s)}r._resetSeqTimeout();if(c){if(e.repeat&&r.settings.noKeyRepeat){e.preventDefault();return false}t=r.trigger(r.scope+"keydown",e,a,s);t=t.concat(r._handleSelectors("keydown",e));h(e,t);if(r.down.length>5){t=t.concat(r.trigger(r.scope+"faceplant",e))}t=t.concat(r.trigger(r.scope+"keydown:"+a.toLowerCase(),e,a,s));t=t.concat(r._handleSelectors("keydown:"+a.toLowerCase(),e));if(o){t=t.concat(r._handleDownEvents(e))}h(e,t)}};r._keypress=function(e){var t=e.charCode||e.which;var n=e.key||String.fromCharCode(t);if(!o&&t>47&&n.length){r.down.pop();r.down.push(n)}};r._keyup=function(e){var t,n=e.which||e.keyCode,i=e.location||0,s=r.keyMaps[i][n]||r.keyMaps[0][n]||e.code,a=e.key||s,c=r.filter(e);a=r._normSpecial(i,a,s);if(!l.length){return}if(r.state.composing){r.state.composing=false;return}if(c){if(!o){r._handleDownEvents(e)}t=r.trigger(r.scope+"keyup",e,a,s);t=t.concat(r._handleSelectors("keyup",e));t=t.concat(r.trigger(r.scope+"keyup:"+a.toLowerCase(),e));t=t.concat(r._handleSelectors("keyup:"+a.toLowerCase(),e));r._handleSeqEvents();h(e,t)}r._removeDown(a);r._setModifiers(s,false)};r._pointerdown=function(e){var t,n,o=r.mouse(e),i=[],a=e.changedTouches,l=e.pointerType,c="pointer",f=":down",p=r.filter(e);if(e.type=="mousedown"&&x){return}if(l){if(l=="touch"){n=e.pointerId;if(!r.touches[n]){r.touches[n]=e}}}else if(a&&a.length){for(t=0;t<a.length;t++){n=a[t].identifier;if(!r.touches[n]){r.touches[n]=a[t]}}}s=_(e,"X");u=_(e,"Y");r._resetSeqTimeout();if(p){i=r.trigger(r.scope+c+f,e);i=i.concat(r._handleSelectors(c+f,e));if(o.buttonName!==undefined){c+=":"+o.buttonName;i=i.concat(r.trigger(r.scope+c+f,e));i=i.concat(r._handleSelectors(c+f,e))}h(e,i)}r._addDown(c);r._handleDownEvents(e)};r._mousedown=r._pointerdown;r._touchstart=r._pointerdown;r._pointerup=function(e){var t,n,o,i,a,l,c,f=e.changedTouches,p=e.pointerType,g=r.settings.swipeThreshold,d=[],m=":up",v="pointer";r.log.debug("_pointerup() event: "+e.type,e,o,"seqBuffer:",r.seqBuffer);if(p){if(p=="touch"){n=e.pointerId;if(r.touches[n]){s=r.touches[n].pageX;u=r.touches[n].pageY;a=e.pageX-s;l=e.pageY-u;delete r.touches[n]}}}else if(f){if(f.length){for(t=0;t<f.length;t++){n=f[t].identifier;if(r.touches[n]){s=r.touches[n].pageX;u=r.touches[n].pageY;a=e.pageX-s;l=e.pageY-u;delete r.touches[n]}}}if(Math.abs(e.pageX-s)<20&&Math.abs(e.pageY-u)<20){x=true}if(e.pageX==s&&e.pageY==u){i=true}}if(x&&e.type=="mouseup"){x=false;return}r._resetSeqTimeout();if(r.filter(e)){d=r.trigger(r.scope+v+m,e);o=r.mouse(e);if(o.buttonName!==undefined){v+=":"+o.buttonName;d=d.concat(r.trigger(r.scope+v+m,e));d=d.concat(r._handleSelectors(v+m,e))}a=s-_(e,"X");l=u-_(e,"Y");c="swipe";if(Math.abs(a)>Math.abs(l)){if(a>g){c+=":left"}else if(a<-g){c+=":right"}}else{if(l>g){c+=":up"}else if(l<-g){c+=":down"}}if(c!="swipe"){r._removeDown(v);r._addDown(c);d=d.concat(r._handleDownEvents(e));d=d.concat(r._handleSelectors(c,e));r._handleSeqEvents();r._removeDown(c)}else{r._handleSeqEvents();r._removeDown(v);if(i){d=d.concat(r.trigger(r.scope+"click",e));d=d.concat(r._handleSelectors("click",e))}h(e,d)}}s=null;u=null};r._mouseup=r._pointerup;r._touchend=r._pointerup;r._pointercancel=function(e){};r._click=function(e){var t,n=r.mouse(e),o="click",i=r.filter(e);r.log.debug("_click()",e,n);r._resetSeqTimeout();if(i){if(n.left){t=r.trigger(r.scope+o,e)}t=r.trigger(r.scope+o+":"+n.buttonName,e);t=t.concat(r._handleSelectors(o,e));h(e,t)}};r._tap=r._click;r._dblclick=function(e){var t,n=r.mouse(e),o="dblclick",i=r.filter(e);r._resetSeqTimeout();if(i){if(n.left){t=r.trigger(r.scope+o,e)}t=r.trigger(r.scope+o+":"+n.buttonName,e);t=t.concat(r._handleSelectors(o,e));h(e,t)}};r._wheel=function(e){var t,n=r.mouse(e),o=r.filter(e),i="wheel";r._resetSeqTimeout();if(o){t=r.trigger(r.scope+i,e);t=t.concat(r._handleSelectors(i,e));if(n.wheelY>0){i+=":down"}else if(n.wheelY<0){i+=":up"}else if(n.wheelX>0){i+=":right";if(r.isDown("shift")){t=t.concat(r.trigger(r.scope+i,e));t=t.concat(r._handleSelectors(i,e))}}else if(n.wheelX<0){i+=":left";if(r.isDown("shift")){t=t.concat(r.trigger(r.scope+i,e));t=t.concat(r._handleSelectors(i,e))}}r._addDown(i);t=t.concat(r._handleDownEvents(e));h(e,t);r._handleSeqEvents();r._removeDown(i)}};r._contextmenu=function(e){var t,n=r.filter(e),o="contextmenu";r._resetSeqTimeout();if(n){t=r.trigger(r.scope+o,e);t=t.concat(r._handleSelectors(o,e))}h(e,t)};r._composition=function(e){var t,n=r.filter(e),o=e.data,i="compos";if(n){t=r.trigger(r.scope+e.type,e,o);if(o){if(e.type=="compositionupdate"){i+='ing:"'+o+'"'}else if(e.type=="compositionend"){i+='ed:"'+o+'"'}t=t.concat(r.trigger(r.scope+i,e));t=t.concat(r._handleSelectors(i,e));h(e,t)}}};r._compositionstart=r._composition;r._compositionupdate=r._composition;r._compositionend=r._composition;r._clipboard=function(t){var n,o,i=r.filter(t),s=t.type+':"';if(i){if(e.clipboardData){n=e.clipboardData.getData("Text")}else if(t.clipboardData){n=t.clipboardData.getData("text/plain")}if(!n&&(t.type=="copy"||t.type=="cut")){n=r.getSelText()}if(n){o=r.trigger(r.scope+t.type,t,n);o=o.concat(r._handleSelectors(t.type,t,n));o=o.concat(r.trigger(r.scope+s+n+'"',t));o=o.concat(r._handleSelectors(s+n+'"',t));h(t,o)}}};r._paste=r._clipboard;r._copy=r._clipboard;r._cut=r._clipboard;r._select=function(e){var t,n=r.getSelText(),o=e.type+':"';t=r.trigger(r.scope+e.type,e,n);t=t.concat(r._handleSelectors(e.type,e,n));if(n){t=t.concat(r.trigger(r.scope+o+n+'"',e,n));t=t.concat(r._handleSelectors(o+n+'"',e));h(e,t)}};r.filter=function(e){var t=(e.target||e.srcElement).tagName,n=["keydown","keyup","keypress"];if(n.indexOf(e.type)!=-1){return!(t=="INPUT"||t=="SELECT"||t=="TEXTAREA")}return true};r.startRecording=function(){r.recording=true;b=[]};r.stopRecording=function(e){var t,n,o=new RegExp(e);r.recording=false;if(!e){return b}if(e=="keystroke"){for(var i=0;i<b.length;i++){if(b[i].indexOf("keyup")!=-1){break}n=b[i]}return n}t=b.filter(function(e){return o.test(e)});return t};r.isDown=function(e){var t,n,o,i=r._downEvents();e=e.toLowerCase();if(i.indexOf(e)!=-1){return true}for(t=0;t<r.down.length;t++){n=r.down[t].toLowerCase();o=l[t].toLowerCase();if(e==n||e==o){return true}else if(r.SHIFTKEYS.indexOf(r.down[t])!=-1){if(e==r.ShiftKeyEvent){return true}}else if(r.CONTROLKEYS.indexOf(r.down[t])!=-1){if(e==r.ControlKeyEvent){return true}}else if(r.ALTKEYS.indexOf(r.down[t])!=-1){if(e==r.AltKeyEvent){return true}}else if(r.OSKEYS.indexOf(r.down[t])!=-1){if(e==r.OSKeyEvent){return true}}}return false};r.getSelText=function(){var t="";if(e.getSelection){t=e.getSelection()}else if(document.getSelection){t=document.getSelection()}else if(document.selection){t=document.selection.createRange().text}else{return}return t.toString()};r.on=function(e,t,n,o){d(e).forEach(function(e){var i,s,a;if(e.indexOf(":")!=-1){a=":"}else if(e.indexOf(":")!=-1){a=" "}if(a){i=new RegExp(a+'(?=(?:(?:[^"]*"){2})*[^"]*$)',"g");s=e.split(i);e="";s.forEach(function(t){t=r.aliases[t]||t;e+=t+a});e=e.replace(new RegExp(a+"+$"),"")}e=r.aliases[e]||e;if(e.length==1&&S(e)){e="shift-"+e}e=e.toLowerCase();if(e.indexOf("-")!=-1){if(e.indexOf("->")==-1){e=r._normCombo(e)}}var l=r.events[e],c={callback:t,context:n,times:o};if(!l){l=r.events[e]=[]}l.push(c)});return r};r.once=function(e,t,n){return r.on(e,t,n,1)};r.off=function(e,t,n){var o,i;if(!arguments.length){r.events={}}else{e=e?d(e):Object.keys(r.events);for(o in e){var s=e[o],a=r.events[s];if(a){var l=[];for(var i in a){if(t){if(a[i].callback.toString()==t.toString()){if(n&&a[i].context!=n){l.push(a[i])}else if(n===null&&a[i].context){l.push(a[i])}}else{l.push(a[i])}}else if(n&&a[i].context!=n){l.push(a[i])}}if(!l.length){delete r.events[s]}else{r.events[s]=l}}}}return r};r.trigger=function(e){var t,n,o,i,s,a=[],l=[];e=d(e);Array.prototype.push.apply(l,arguments);l.shift();for(t=0;t<e.length;t++){o=r.aliases[e[t]]||e[t];r.log.debug("Triggering:",o,l);if(r.recording){b.push(o)}i=r.events[o];if(i){for(n=0;n<i.length;n++){s=i[n];if(s.times){s.times-=1;if(s.times==0){r.off(o,s.callback,s.context)}}a.push(s.callback.apply(s.context||this,l))}}}return a};r.emit=r.trigger;if(typeof document.hidden!=="undefined"){document.addEventListener("visibilitychange",function(e){if(document.hidden){r.trigger("document:hidden",e)}else{r.trigger("document:visible",e)}},false)}if(r.elem===e){["resize","beforeunload","hashchange","languagechange"].forEach(function(t){e.addEventListener(t,r._genericEvent.bind(r,"window"),true)});if(e.orientation!==undefined){e.addEventListener("orientationchange",function(t){r.trigger("window:orientation",t);if(Math.abs(e.orientation)===90){r.trigger("window:orientation:landscape",t)}else{r.trigger("window:orientation:portrait",t)}},false)}}r.init(r)};E.plugins=[];if(e.PointerEvent){E.defaultListenEvents=i.concat(r)}else{E.defaultListenEvents=i.concat(s)}E.prototype.init=function(o){var i,r,s,u;o.scope="";o.down=[];o.modifiers={};o.seqBuffer=[];o.touches={};o.state={};o.aliases={tap:"click",middleclick:"pointer:middle",rightclick:"pointer:right",doubleclick:"dblclick",tripleclick:Array(4).join("pointer:left ").trim(),quadrupleclick:Array(5).join("pointer:left ").trim(),konami:"up up down down left right left right b a enter",portrait:"window:orientation:portrait",landscape:"window:orientation:landscape",hulksmash:"faceplant"};o.events={};a=false;l=[];c=null;if(o.settings.disableSequences){o._handleSeqEvents=f}if(o.settings.disableSelectors){o._handleSelectors=f}if(o.elem===e){o.on("window:resize",function(){if(e.outerWidth===screen.width&&e.outerHeight===screen.height){o.state.fullscreen=true;o.trigger("fullscreen",true)}else if(o.state.fullscreen){o.state.fullscreen=false;o.trigger("fullscreen",false)}})}o.off("hi:pause");o.on("hi:pause",function(){o.log.debug(t("Pause: Removing event listeners"));o.settings.listenEvents.forEach(function(e){var t=o.settings.eventOptions[e]||true;if(y.isFunction(o["_"+e])){o.elem.removeEventListener(e,o["_"+e],t)}})});o.off(["hi:initialized","hi:resume"]);o.on(["hi:initialized","hi:resume"],function(){o.log.debug("HumanInput Version: "+o.__version__);o.log.debug(t("Start/Resume: Addding event listeners"),o.settings.listenEvents);o.settings.listenEvents.forEach(function(e){var t=o.settings.eventOptions[e]||true;if(y.isFunction(o["_"+e])){o.elem.removeEventListener(e,o["_"+e],t);o.elem.addEventListener(e,o["_"+e],t)}else{o["_"+e]=o._genericEvent.bind(o,o.elem.name);o.elem.addEventListener(e,o["_"+e],t)}})});o.keyMaps={0:{Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,Pause:19,CapsLock:20,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,Left:37,ArrowUp:38,Up:38,ArrowRight:39,Right:39,ArrowDown:40,Down:40,PrintScreen:42,Insert:45,Delete:46,Semicolon:59,"=":61,OS:92,Select:93,NumLock:144,ScrollLock:145,VolumeDown:174,VolumeUp:175,MediaTrackPrevious:177,MediaPlayPause:179,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222,AltGraph:225,Compose:229},1:{ShiftLeft:16,ControlLeft:17,AltLeft:18,OSLeft:91},2:{ShiftRight:16,ControlRight:17,AltRight:18,OSRight:92}};if(o.settings.uniqueNumpad){o.keyMaps[3]={NumpadMultiply:106,NumpadAdd:107,NumpadSubtract:109,NumpadDecimal:46,Slash:111}}else{o.keyMaps[3]={"*":106,"+":107,"-":109,".":46,"/":111}}for(i=48;i<=57;i++){o.keyMaps[0][i]=""+(i-48)}for(i=65;i<=90;i++){o.keyMaps[0][i]=String.fromCharCode(i)}for(i=96;i<=105;i++){o.keyMaps[3][i]="Numpad"+(i-96)}for(i=112;i<=123;i++){o.keyMaps[0][i]="F"+(i-112+1)}if(n){o.keyMaps[0]={3:"Enter",63289:"NumpadClear",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"ArrowLeft",63232:"ArrowUp",63235:"ArrowRight",63233:"ArrowDown",63302:"Insert",63272:"Delete"};for(i=63236;i<=63242;i++){o.keyMaps[0][i]="F"+(i-63236+1)}}for(i=0;i<=3;i++){Object.keys(o.keyMaps[i]).forEach(function(e){if(e.length>1&&!isNaN(e)){e=parseInt(e)}o.keyMaps[i][o.keyMaps[i][e]]=e})}if(E.plugins.length){for(i=0;i<E.plugins.length;i++){r=new E.plugins[i](o);o.log.debug(t("Initializing Plugin:"),r.__name__);if(y.isFunction(r.init)){s=r.init(o);for(u in s.exports){o[u]=s.exports[u]}}}}o.trigger("hi:initialized",o)};E.prototype.logger=function(t,n){var o=this,i=function(){var t=y.toArray(arguments);t[0]=n+o.levels[level]+": "+t[0];if(y.isFunction(e.console.log)){e.console.log.apply(e.console,t)}},r=function(t){var r=Array.prototype.slice.call(arguments,1);if(n.length){r.unshift(n)}if(t==40&&o.logLevel<=40){if(y.isFunction(e.console.error)){e.console.error.apply(e.console,r)}else{i.apply(o,r)}}else if(t==30&&o.logLevel<=30){if(y.isFunction(e.console.warn)){e.console.warn.apply(e.console,r)}else{i.apply(o,r)}}else if(t==20&&o.logLevel<=20){if(y.isFunction(e.console.info)){e.console.info.apply(e.console,r)}else{i.apply(o,r)}}else if(t==10&&o.logLevel<=10){if(y.isFunction(e.console.debug)){e.console.debug.apply(e.console,r)}else{i.apply(o,r)}}};n=n||"";if(n.length){n+=":"}o.levels={40:"ERROR",30:"WARNING",20:"INFO",10:"DEBUG",ERROR:40,WARNING:30,INFO:20,DEBUG:10};o.setLevel=function(e){e=e.toUpperCase();o.error=y.partial(r,40);o.warn=y.partial(r,30);o.info=y.partial(r,20);o.debug=y.partial(r,10);o.logLevel=e;if(isNaN(e)){o.logLevel=e=o.levels[e]}if(e>40){o.error=f}if(e>30){o.warn=f}if(e>20){o.info=f}if(e>10){o.debug=f}};o.setLevel(t)};E.prototype.pushScope=function(e){if(this.scope.length){this.scope=this.scope.slice(0,-1)+"."+e+":"}else{this.scope=e+":"}};E.prototype.popScope=function(){if(this.scope.length){this.scope=this.scope.slice(0,-1).split(".").slice(0,-1).join(".")+":"}if(this.scope==":"){this.scope=""}};E.prototype.pause=function(){this.state.paused=true;this.trigger("hi:pause",this)};E.prototype.resume=function(){this.state.paused=false;this.trigger("hi:resume",this)};E.prototype._seqSlicer=function(e){var t=[],n,o,i;e=e.split(/ +(?=(?:(?:[^"]*"){2})*[^"]*$)/g);for(n=0;n<e.length-1;n++){o=e.slice(n);i=o.join(" ");if(t.indexOf(i)==-1){t.push(i)}}return t};E.prototype._sortEvents=function(e){var t,n=this,o=n.CONTROLKEYS.concat(["ctrl"]),i=n.ALTKEYS.concat(n.AltAltNames),r=n.OSKEYS.concat(n.AltOSNames),s={};for(t=0;t<o.length;t++){s[o[t].toLowerCase()]=5}for(t=0;t<n.SHIFTKEYS.length;t++){s[n.SHIFTKEYS[t].toLowerCase()]=4}for(t=0;t<i.length;t++){s[i[t].toLowerCase()]=3}for(t=0;t<r.length;t++){s[r[t].toLowerCase()]=2}e.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())});e.sort(function(e,t){return t.length-e.length});e.sort(function(e,t){e=e.toLowerCase();t=t.toLowerCase();if(e in s){if(t in s){if(s[e]>s[t]){return-1}else if(s[e]<s[t]){return 1}else{return 0}}return-1}else if(t in s){return 1}else{return 0}});return e};E.prototype._normCombo=function(e){var t=this,n,o=e.split("-"),i=o.length,r=function(e){if(e=="control"){return t.ControlKeyEvent}return e},s=function(e){for(var n=0;n<t.AltAltNames.length;n++){if(e==t.AltAltNames[n]){return t.AltKeyEvent}}return e},a=function(e){for(var n=0;n<t.AltOSNames.length;n++){if(e==t.AltOSNames[n]){return t.OSKeyEvent}}return e};for(n=0;n<i;n++){if(o[n]==""){o[n]=="-"}o[n]=o[n].toLowerCase();o[n]=r(o[n]);o[n]=s(o[n]);o[n]=a(o[n])}t._sortEvents(o);return o.join("-")};E.prototype.mouse=function(e){var t={type:e.type};if(e.type!="mousemove"&&e.type!="mousewheel"&&e.type!="wheel"){if(e.button==0){t.left=true;t.buttonName="left"}else if(e.button==1){t.middle=true;t.buttonName="middle"}else if(e.button==2){t.right=true;t.buttonName="right"}else if(e.button==3){t.back=true;t.buttonName="back"}else if(e.button==4){t.forward=true;t.buttonName="forward"}else if(e.button==5){t.forward=true;t.buttonName="eraser"}else{t.buttonName=e.button}}t.button=e.button;if(e.type=="wheel"||e.type=="mousewheel"){if(e.wheelDeltaX||e.wheelDeltaY){t.wheelX=e.wheelDeltaX/-40||0;t.wheelY=e.wheelDeltaY/-40||0}else if(e.wheelDelta){t.wheelY=e.wheelDelta/-40}else{t.wheelY=e.detail||0}}return t};if(typeof module!=="undefined"&&module.exports){module.exports=E}if(typeof define==="function"&&define.amd){define([],function(){return E})}else if(typeof exports!=="undefined"&&exports!==null){exports.HumanInput=E}else{e.HumanInput=E}}).call(this);(function(){"use strict";var e=function(e){var t=this;t.__name__="GamepadPlugin";t.exports={};t.gamepads=[];t._gamepadTimer=null;t.gamepadUpdate=function(){var n,o,i,r,s,a,l,c,f={type:"gamepad",target:e.elem},u=navigator.getGamepads();for(n=0;n<u.length;++n){if(u[n]){i=u[n].index,s=t.gamepads[i];if(!s){t.log.debug("Gamepad "+i+" detected:",u[n]);e.trigger("gpad:connected",u[n]);t.gamepads[i]={axes:[],buttons:[],timestamp:u[n].timestamp,id:u[n].id};s=t.gamepads[i];for(o=0;o<u[n].buttons.length;o++){s.buttons[o]={value:0,pressed:false}}for(o=0;o<u[n].axes.length;o++){s.axes[o]=0}continue}else{if(s.timestamp==u[n].timestamp){continue}r=JSON.parse(JSON.stringify(s));s.timestamp=u[n].timestamp;s.axes=u[n].axes.slice(0);for(o=0;o<r.buttons.length;o++){s.buttons[o].pressed=u[n].buttons[o].pressed;s.buttons[o].value=u[n].buttons[o].value}}for(o=0;o<s.buttons.length;o++){a="up";if(s.buttons[o].pressed){a="down"}l="gpad:button:"+o;if(a=="down"){if(!e.isDown(l)){e._addDown(l)}}else{if(e.isDown(l)){e._handleSeqEvents();e._removeDown(l)}}if(s.buttons[o].pressed!=r.buttons[o].pressed){e.trigger(e.scope+l+":"+a,s.buttons[o].value,u[n]);c=true}if(s.buttons[o].value!=r.buttons[o].value){e.trigger(e.scope+l+":value",s.buttons[o].value,u[n])}}if(e.filter(f)){for(o=0;o<r.axes.length;o++){if(s.axes[o]!=r.axes[o]){l="gpad:axis:"+o;e.trigger(e.scope+l,s.axes[o],u[n])}}if(c){e._handleDownEvents(u[n])}}}}};t.loadController=function(t){for(var n in t){e.aliases[n]=t[n]}};return t};e.prototype.init=function(e){var t=this,n=function(){clearInterval(t._gamepadTimer)},o=function(){clearInterval(t._gamepadTimer);if(t.gamepads.length){t._gamepadTimer=setInterval(t.gamepadUpdate,e.settings.gpadInterval)}else{t._gamepadTimer=setInterval(t.gamepadUpdate,e.settings.gpadCheckInterval)}};t.log=new e.logger(e.settings.logLevel||"INFO","[HI Gamepad]");t.log.debug("Initializing Gamepad Plugin",t);e.settings.gpadInterval=e.settings.gpadInterval||100;e.settings.gpadCheckInterval=e.settings.gpadCheckInterval||3e3;clearInterval(t._gamepadTimer);if(e.settings.listenEvents.indexOf("gamepad")!=-1){t.gamepadUpdate();o();e.on("document:hidden",n);e.on("document:visibile",o)}t.exports.gamepads=t.gamepads;t.exports._gamepadTimer=t._gamepadTimer;t.exports.gamepadUpdate=t.gamepadUpdate;t.exports.loadController=t.loadController;return t};HumanInput.plugins.push(e)}).call(this);(function(){"use strict";HumanInput.defaultListenEvents.push("speech");var e=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition;var t=function(e){var t=this;t.__name__="SpeechRecPlugin";t.exports={};t._rtSpeech=[];t._rtSpeechPop=function(){t._rtSpeech.reverse();t._rtSpeech.pop();t._rtSpeech.reverse()};t._rtSpeechTimer=null;t.startSpeechRec=function(){t._recognition=new webkitSpeechRecognition;t.log.debug("Starting speech recognition",t._recognition);t._recognition.lang=e.settings.speechLang||navigator.language||"en-US";t._recognition.continuous=true;t._recognition.interimResults=true;t._recognition.onresult=function(n){var o,i,r;for(o=n.resultIndex;o<n.results.length;++o){r=n.results[o][0].transcript.trim();if(n.results[o].isFinal){i='speech:"'+r.replace(/-/g,"–")+'"';e._addDown(i);e._handleDownEvents(n,r);e._handleSeqEvents();e._removeDown(i)}else{i="speech:rt:"+r.replace(/-/g,"–")+'"';if(t._rtSpeech.indexOf(i)==-1){t._rtSpeech.push(i);e._addDown(i);e._handleDownEvents(n,r);e._removeDown(i)}}}};t._started=true;t._recognition.start()};t.stopSpeechRec=function(){t.log.debug("Stopping speech recognition");t._recognition.stop();t._started=false};return t};t.prototype.init=function(t){var n=this,o=t.l;n.log=new t.logger(t.settings.logLevel||"INFO","[HI Speech]");n.log.debug(o("Initializing Speech Recognition Plugin"),n);t.settings.autostartSpeech=t.settings.autostartSpeech||false;if(t.settings.listenEvents.indexOf("speech")!=-1){if(e){if(t.settings.autostartSpeech){n.startSpeechRec()}t.on("document:hidden",function(){if(n._started){n.stopSpeechRec()}});t.on("document:visible",function(){if(!n._started&&t.settings.autostartSpeech){n.startSpeechRec()}})}else{n.startSpeechRec=t.noop;n.stopSpeechRec=t.noop}}n.exports.startSpeechRec=n.startSpeechRec;n.exports.stopSpeechRec=n.stopSpeechRec;return n};HumanInput.plugins.push(t)}).call(this);(function(){"use strict";navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;HumanInput.defaultListenEvents.push("clapper");var e=window.AudioContext||window.webkitAudioContext,t=60,n=function(n){var o=this;o.__name__="ClapperPlugin";o.exports={};o.startClapper=function(){var i=function(e){var i,r,s;o.stream=e;o.scriptProcessor.connect(o.context.destination);o.analyser.smoothingTimeConstant=.4;o.analyser.fftSize=128;o.streamSource=o.context.createMediaStreamSource(e);o.streamSource.connect(o.analyser);o.analyser.connect(o.scriptProcessor);o.scriptProcessor.onaudioprocess=function(){var e,a,l,c,f=Date.now();if(!i){i=f;r=f}e=f-i;a=f-r;l=f-s;if(e>t){o.analyser.getByteFrequencyData(o.freqData);if(a>=t*4&&o.freqData.filter(function(e){return e>=n.settings.clapThreshold}).length>=15){c="clap";if(a<t*8){c="doubleclap";s=f;if(l<t*12){c="applause"}}n._addDown(c);n._handleDownEvents();n._handleSeqEvents();n._removeDown(c);r=f}i=f}o.freqData=new Uint8Array(o.analyser.frequencyBinCount)}};o.context=new e;o.scriptProcessor=o.context.createScriptProcessor(1024,1,1);o.analyser=o.context.createAnalyser();o.freqData=new Uint8Array(o.analyser.frequencyBinCount);o.log.debug("Starting clap detection");o._started=true;navigator.getUserMedia({audio:true},i,function(e){o.log.error("Could not get audio stream",e)})};o.stopClapper=function(){o.log.debug("Stopping clap detection");o.stream.getAudioTracks().forEach(function(e){e.stop()});o.stream.getVideoTracks().forEach(function(e){e.stop()});o.streamSource.disconnect(o.analyser);o.analyser.disconnect(o.scriptProcessor);o.scriptProcessor.disconnect(o.context.destination);o._started=false};return o};n.prototype.init=function(t){var n=this,o=t.l;n.log=new t.logger(t.settings.logLevel||"INFO","[HI Clapper]");n.log.debug(o("Initializing Clapper Plugin"),n);t.settings.autostartClapper=t.settings.autostartClapper||false;t.settings.clapThreshold=t.settings.clapThreshold||120;t.settings.autotoggleClapper=t.settings.autotoggleClapper||true;if(t.settings.listenEvents.indexOf("clapper")!=-1){if(e){if(t.settings.autostartClapper){n.startClapper()}if(t.settings.autotoggleClapper){t.on("document:hidden",function(){if(n._started){n.stopClapper()}});t.on("document:visible",function(){if(!n._started&&t.settings.autostartClapper){n.startClapper()}})}}else{n.startClapper=t.noop;n.stopClapper=t.noop}}n.exports.startClapper=n.startClapper;n.exports.stopClapper=n.stopClapper;return n};HumanInput.plugins.push(n)}).call(this);
