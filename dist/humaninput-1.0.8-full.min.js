(function(){"use strict";var e=this,t=navigator.userAgent.indexOf("Mac OS X")!=-1,n=false,i=["keydown","keypress","keyup","click","dblclick","wheel","contextmenu","compositionstart","compositionupdate","compositionend","cut","copy","paste","select"],o=["pointerdown","pointerup"],r=["mousedown","mouseup","touchstart","touchend"],s=false,a=[],l,c=function(e){return e},f=Object.prototype.toString,u=function(e){var t="";if(e.name){t+=" "+e.name}else if(e.id){t+=" "+e.id}else if(e.nodeName){t+=" "+e.nodeName}return"[HI"+t+"]"},p=function(e){if(typeof e==="string"){var t=document.querySelector(e);return t}return e},d=function(e){if(w.isString(e)){return[e]}return e},g=function(e,t){if(t.indexOf(false)!=-1){e.preventDefault()}},h=function(e){var t,n;if(w.isArray(e)){t=e.slice(0);for(n=0;n<t.length;n++){t[n]=h(t[n])}return t}else{return e}},m=function(e,t){var n=[],i,o,r;if(e.length==1){return e[0]}else{i=m(e.slice(1),t);for(o=0;o<i.length;o++){for(r=0;r<e[0].length;r++){n.push(e[0][r]+t+i[o])}}return n}},v=function(e,t){return/touch/.test(e.type)?(e.originalEvent||e).changedTouches[0]["page"+t]:e["page"+t]},_=function(e){if(e==e.toUpperCase()){return true}},S=function(e,t){return t!=null&&e!=null&&t.indexOf(e)==0},w=w||c;["Function","String","Number"].forEach(function(e){w["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}});w.isArray=Array.isArray;w.toArray=function(e){var t,n=[];for(t=e.length>>>0;t--;){n[t]=e[t]}return n};w.partial=function(e){var t=w.toArray(arguments);t.shift();return function(){return e.apply(this,t.concat(w.toArray(arguments)))}};w.isEqual=function(e,t){return e&&t&&typeof e==="object"&&typeof t==="object"?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(function(n,i){return n&&w.isEqual(e[i],t[i])},true):e===t};if(Object.keys(KeyboardEvent.prototype).indexOf("key")!=-1){n=true}var y=function(t,i){if(!(this instanceof y)){return new y(t,i)}var o=this,r,f,E,b,O,x,C,k,R=0;o.VERSION="1.0.8";o.OSKEYS=["OS","OSLeft","OSRight"],o.CONTROLKEYS=["Control","ControlLeft","ControlRight"],o.ALTKEYS=["Alt","AltLeft","AltRight"],o.SHIFTKEYS=["Shift","ShiftLeft","ShiftRight","⇧"],o.ALLMODIFIERS=o.OSKEYS.concat(o.CONTROLKEYS,o.ALTKEYS,o.SHIFTKEYS),o.MODIFIERPRIORITY={};o.ControlKeyEvent="ctrl";o.ShiftKeyEvent="shift";o.AltKeyEvent="alt";o.OSKeyEvent="os";o.AltAltNames=["option","⌥"];o.AltOSNames=["meta","win","⌘","cmd","command"];i=i||{};o.l=i.translate||c;i.listenEvents=i.listenEvents||y.defaultListenEvents;i.eventOptions=i.eventOptions||{};i.noKeyRepeat=i.noKeyRepeat||true;i.sequenceTimeout=i.sequenceTimeout||3e3;i.maxSequenceBuf=i.maxSequenceBuf||12;i.uniqueNumpad=i.uniqueNumpad||false;i.swipeThreshold=i.swipeThreshold||100;i.disableSequences=i.disableSequences||false;i.disableSelectors=i.disableSelectors||false;o.settings=i;o.elem=p(t||e);o.log=new o.logger(i.logLevel||"INFO",u(t));x=o.CONTROLKEYS.concat(["ctrl"]);C=o.ALTKEYS.concat(o.AltAltNames);k=o.OSKEYS.concat(o.AltOSNames);for(r=0;r<x.length;r++){o.MODIFIERPRIORITY[x[r].toLowerCase()]=5}for(r=0;r<o.SHIFTKEYS.length;r++){o.MODIFIERPRIORITY[o.SHIFTKEYS[r].toLowerCase()]=4}for(r=0;r<C.length;r++){o.MODIFIERPRIORITY[C[r].toLowerCase()]=3}for(r=0;r<k.length;r++){o.MODIFIERPRIORITY[k[r].toLowerCase()]=2}o._getInstanceName=function(){for(var t in e){if(e[t]===o)return t}};o._resetKeyStates=function(){o.modifiers={};o.seqBuffer=[];o.down=[];a=[];R=0;s=false};o._addDown=function(e,t){var n=o.down.indexOf(e);if(n==-1){n=a.indexOf(e)}if(n==-1&&t){n=a.indexOf(t)}if(n==-1){o.down.push(e);if(t){a.push(t)}else{a.push(e)}}};o._removeDown=function(e){var t=o.down.indexOf(e);if(t==-1){t=a.indexOf(e)}if(t==-1){t=a.indexOf(e.toUpperCase())}if(t!=-1){o.down.splice(t,1);a.splice(t,1)}R=o.down.length};o._doDownEvent=function(e){var t,n=w.toArray(arguments).slice(1);o._addDown(e);t=o._handleDownEvents.apply(o,n);o._handleSeqEvents();o._removeDown(e);return t};o._resetSeqTimeout=function(){clearTimeout(l);l=setTimeout(function(){o.log.debug(o.l("Resetting key states due to timeout"));o._resetKeyStates()},o.settings.sequenceTimeout)};o._genericEvent=function(e,t){var n=o.filter(t),i;if(n){if(e.type){t=e;e=null}if(e){e=e+":"}else{e=""}i=o.trigger(o.scope+e+t.type,t);if(t.target){i=i.concat(o._handleSelectors(e+t.type,t))}g(t,i)}};o._handleSelectors=function(e){var t=[],n=w.toArray(arguments).slice(1),i=o,r;if(n[0]&&n[0].target){i=n[0].target;if(i.id){r=e+":#"+i.id;t=o.trigger.apply(i,[r].concat(n))}if(i.classList&&i.classList.length){for(var s=0;s<i.classList.length;s++){r=e+":."+i.classList.item(s);t=t.concat(o.trigger.apply(i,[r].concat(n)))}}}return t};o._triggerWithSelectors=function(e,t){var n=[],i=o.scope+e;n=n.concat(o.trigger.apply(o,[i].concat(t)));n=n.concat(o._handleSelectors.apply(o,[i].concat(t)));return n};o._keyEvent=function(e){if(o.CONTROLKEYS.indexOf(e)!=-1){return o.ControlKeyEvent}else if(o.ALTKEYS.indexOf(e)!=-1){return o.AltKeyEvent}else if(o.SHIFTKEYS.indexOf(e)!=-1){return o.ShiftKeyEvent}else if(o.OSKEYS.indexOf(e)!=-1){return o.OSKeyEvent}else{return e.toLowerCase()}};o._seqCombinations=function(e,t){t=t||"-";var n=h(e),i=[],r=[],s,a;for(s=0;s<e.length;s++){i.push(n[s].join(t).toLowerCase())}i=[i.join(" ")];for(s=0;s<e.length;s++){for(a=0;a<e[s].length;a++){n[s][a]=[o._keyEvent(e[s][a])]}}for(s=0;s<n.length;s++){r.push(m(n[s],t))}r=r.join(" ");if(r!=i[0]){i.push(r)}return i};o._downEvents=function(){var e,t=[],n,i=-1,r,s=o.down.slice(0),l=a.slice(0);if(s.length){if(s.length>1){if(o.modifiers.shift){for(e=0;e<s.length;e++){i=s[e].indexOf("Shift");if(i!=-1){break}}}for(e=0;e<s.length;e++){if(s[e]!=a[e]&&i!=-1){r=true}}if(r){if(s.length==2){n=true}s.splice(i,1)}if(!n){t=t.concat(o._seqCombinations([s],"->"));if(r){t=t.concat(o._seqCombinations([l],"->"))}}}o._sortEvents(s);t=t.concat(o._seqCombinations([s]));if(r){o._sortEvents(l);t=t.concat(o._seqCombinations([l]))}}return t};o._handleDownEvents=function(){var e,t,n,i=w.toArray(arguments);t=o._downEvents();for(e=0;e<t.length;e++){n=o._triggerWithSelectors(t[e],i)}return n};o._handleSeqEvents=function(){var e,t,n,i=o.down.slice(0);if(R<i.length){i=o._sortEvents(i);o.seqBuffer.push(i);if(o.seqBuffer.length>o.settings.maxSequenceBuf){o.seqBuffer.shift()}if(o.seqBuffer.length>1){e=o._seqCombinations(o.seqBuffer);for(t=0;t<e.length;t++){o._seqSlicer(e[t]).forEach(function(e){n=o.trigger(o.scope+e,o)})}if(n.length){o.seqBuffer=[]}}}o._resetSeqTimeout()};o._normSpecial=function(e,t,n){if(n.indexOf("Left")!=-1||n.indexOf("Right")!=-1){t=n}else if(o.settings.uniqueNumpad&&e==3){return"numpad"+t}if(S("arrow",t.toLowerCase())){t=t.substr(5)}return t};o._setModifiers=function(e,t){if(o.ALLMODIFIERS.indexOf(e)){if(o.SHIFTKEYS.indexOf(e)!=-1){o.modifiers.shift=t}if(o.CONTROLKEYS.indexOf(e)!=-1){o.modifiers.ctrl=t}if(o.ALTKEYS.indexOf(e)!=-1){o.modifiers.alt=t;o.modifiers.option=t;o.modifiers["⌥"]=t}if(o.OSKEYS.indexOf(e)!=-1){o.modifiers.meta=t;o.modifiers.command=t;o.modifiers.os=t;o.modifiers["⌘"]=t}o.modifiers[e]=t}};o._keydown=function(e){var t,i=e.which||e.keyCode,r=e.location||0,s=o.keyMaps[r][i]||o.keyMaps[0][i]||e.code,l=e.key||s,c=e.type,f=o.scope+"faceplant",u=o.filter(e);l=o._normSpecial(r,l,s);o._setModifiers(l,true);if(l=="Compose"){o.state.composing=true;return}if(a.indexOf(l)==-1){o._addDown(l,s)}o._resetSeqTimeout();if(u){if(e.repeat&&o.settings.noKeyRepeat){e.preventDefault();return false}t=o._triggerWithSelectors(c,[e,l,s]);t=t.concat(o._triggerWithSelectors(c=":"+l.toLowerCase(),[e,l,s]));if(o.down.length>5){t=t.concat(o.trigger(f,e))}if(n){t=t.concat(o._handleDownEvents(e,l,s))}g(e,t)}};o._keypress=function(e){var t=e.charCode||e.which,i=e.key||String.fromCharCode(t);if(!n&&t>47&&i.length){o.down.pop();o.down.push(i)}};o._keyup=function(e){var t,i=e.which||e.keyCode,r=e.location||0,s=o.keyMaps[r][i]||o.keyMaps[0][i]||e.code,l=e.key||s,c=e.type,f=o.filter(e);l=o._normSpecial(r,l,s);if(!a.length){return}if(o.state.composing){o.state.composing=false;return}if(f){if(!n){o._handleDownEvents(e)}t=o._triggerWithSelectors(c,[e,l,s]);t=t.concat(o._triggerWithSelectors(c+":"+l.toLowerCase(),[e,l,s]));o._handleSeqEvents();g(e,t)}o._removeDown(l);o._setModifiers(s,false)};o._pointerdown=function(e){var t,n,i=o.mouse(e),r,s=e.changedTouches,a=e.pointerType,l="pointer",c=":down",u=o.filter(e);if(e.type=="mousedown"&&O){return}if(a){if(a=="touch"){n=e.pointerId;if(!o.touches[n]){o.touches[n]=e}}}else if(s&&s.length){for(t=0;t<s.length;t++){n=s[t].identifier;if(!o.touches[n]){o.touches[n]=s[t]}}}f=v(e,"X");E=v(e,"Y");o._resetSeqTimeout();if(u){r=o._triggerWithSelectors(l+c,[e]);if(i.buttonName!==undefined){l+=":"+i.buttonName;r=r.concat(o._triggerWithSelectors(l+c,[e]))}g(e,r)}o._addDown(l);o._handleDownEvents(e)};o._mousedown=o._pointerdown;o._touchstart=o._pointerdown;o._pointerup=function(e){var t,n,i,r,s,a,l,c=e.changedTouches,u=e.pointerType,p=o.settings.swipeThreshold,d,h=":up",m="pointer";if(u){if(u=="touch"){n=e.pointerId;if(o.touches[n]){f=o.touches[n].pageX;E=o.touches[n].pageY;s=e.pageX-f;a=e.pageY-E;delete o.touches[n]}}}else if(c){if(c.length){for(t=0;t<c.length;t++){n=c[t].identifier;if(o.touches[n]){f=o.touches[n].pageX;E=o.touches[n].pageY;s=e.pageX-f;a=e.pageY-E;delete o.touches[n]}}}if(Math.abs(e.pageX-f)<20&&Math.abs(e.pageY-E)<20){O=true}if(e.pageX==f&&e.pageY==E){r=true}}if(O&&e.type=="mouseup"){O=false;return}o._resetSeqTimeout();if(o.filter(e)){d=o._triggerWithSelectors(m+h,[e]);i=o.mouse(e);if(i.buttonName!==undefined){m+=":"+i.buttonName;d=d.concat(o._triggerWithSelectors(m+h,[e]))}s=f-v(e,"X");a=E-v(e,"Y");l="swipe";if(Math.abs(s)>Math.abs(a)){if(s>p){l+=":left"}else if(s<-p){l+=":right"}}else{if(a>p){l+=":up"}else if(a<-p){l+=":down"}}if(l!="swipe"){o._removeDown(m);o._addDown(l);d=d.concat(o._handleDownEvents(e));d=d.concat(o._handleSelectors(l,e));o._handleSeqEvents();o._removeDown(l)}else{o._handleSeqEvents();o._removeDown(m);if(r){d=d.concat(o._triggerWithSelectors("click",[e]))}g(e,d)}}f=null;E=null};o._mouseup=o._pointerup;o._touchend=o._pointerup;o._click=function(e){var t=[],n=o.mouse(e),i=e.type,r=o.filter(e);o._resetSeqTimeout();if(r){if(n.left){t=t.concat(o._triggerWithSelectors(i,[e]))}t=t.concat(o._triggerWithSelectors(i+":"+n.buttonName,[e]));g(e,t)}};o._tap=o._click;o._dblclick=o._click;o._wheel=function(e){var t,n=o.filter(e),i="wheel";o._resetSeqTimeout();if(n){t=o._triggerWithSelectors(i,[e]);if(e.deltaY>0){t=t.concat(o._doDownEvent(i+":down",e))}else if(e.deltaY<0){t=t.concat(o._doDownEvent(i+":up",e))}if(e.deltaZ>0){t=t.concat(o._doDownEvent(i+":out",e))}else if(e.deltaZ<0){t=t.concat(o._doDownEvent(i+":in",e))}if(e.deltaX>0){t=t.concat(o._doDownEvent(i+":right",e));if(o.isDown("shift")){t=t.concat(o._triggerWithSelectors(i+":right",[e]))}}else if(e.deltaX<0){t=t.concat(o._doDownEvent(i+":left",e));if(o.isDown("shift")){t=t.concat(o._triggerWithSelectors(i+":left",[e]))}}g(e,t)}};o._contextmenu=function(e){var t,n=o.filter(e),i="contextmenu";o._resetSeqTimeout();if(n){t=o._triggerWithSelectors(i,[e]);g(e,t)}};o._composition=function(e){var t,n=o.filter(e),i=e.data,r="compos";if(n){t=o._triggerWithSelectors(e.type,[e,i]);if(i){if(e.type=="compositionupdate"){r+='ing:"'+i+'"'}else if(e.type=="compositionend"){r+='ed:"'+i+'"'}t=t.concat(o._triggerWithSelectors(r,[e]));g(e,t)}}};o._compositionstart=o._composition;o._compositionupdate=o._composition;o._compositionend=o._composition;o._clipboard=function(t){var n,i,r=o.filter(t),s=t.type+':"';if(r){if(e.clipboardData){n=e.clipboardData.getData("Text")}else if(t.clipboardData){n=t.clipboardData.getData("text/plain")}if(!n&&(t.type=="copy"||t.type=="cut")){n=o.getSelText()}if(n){i=o._triggerWithSelectors(t.type,[t,n]);i=i.concat(o._triggerWithSelectors(s+n+'"',[t]));g(t,i)}}};o._paste=o._clipboard;o._copy=o._clipboard;o._cut=o._clipboard;o._select=function(e){var t,n=o.getSelText(),i=o.filter(e),r=e.type+':"';if(i){t=o._triggerWithSelectors(e.type,[e,n]);if(n){t=t.concat(o._triggerWithSelectors(r+n+'"',[e]));g(e,t)}}};o.filter=function(e){var t=(e.target||e.srcElement).tagName,n=["keydown","keyup","keypress"];if(n.indexOf(e.type)!=-1){return!(t=="INPUT"||t=="SELECT"||t=="TEXTAREA")}return true};o.startRecording=function(){o.recording=true;b=[]};o.stopRecording=function(e){var t,n,i,r=new RegExp(e),s=function(e){return e.indexOf(":#")==-1&&e.indexOf(":.")==-1};o.recording=false;if(!e){return b}if(e=="keystroke"){i=b.filter(s);r=new RegExp("keyup");for(var a=0;a<i.length;a++){if(r.test(i[a])){break}n=i[a]}return n}t=b.filter(function(e){return r.test(e)});return t};o.isDown=function(e){var t,n,i,r=o._downEvents();e=e.toLowerCase();if(r.indexOf(e)!=-1){return true}for(t=0;t<o.down.length;t++){n=o.down[t].toLowerCase();i=a[t].toLowerCase();if(e==n||e==i){return true}else if(o.SHIFTKEYS.indexOf(o.down[t])!=-1){if(e==o.ShiftKeyEvent){return true}}else if(o.CONTROLKEYS.indexOf(o.down[t])!=-1){if(e==o.ControlKeyEvent){return true}}else if(o.ALTKEYS.indexOf(o.down[t])!=-1){if(e==o.AltKeyEvent){return true}}else if(o.OSKEYS.indexOf(o.down[t])!=-1){if(e==o.OSKeyEvent){return true}}}return false};o.getSelText=function(){var t="";if(e.getSelection){t=e.getSelection()}else if(document.getSelection){t=document.getSelection()}else if(document.selection){t=document.selection.createRange().text}else{return}return t.toString()};o.on=function(e,t,n,i){d(e).forEach(function(e){var r,s,a;if(e.indexOf(":")!=-1){a=":"}else if(e.indexOf(":")!=-1){a=" "}if(a){r=new RegExp(a+'(?=(?:(?:[^"]*"){2})*[^"]*$)',"g");s=e.split(r);e="";s.forEach(function(t){t=o.aliases[t]||t;e+=t+a});e=e.replace(new RegExp(a+"+$"),"")}e=o.aliases[e]||e;if(e.length==1&&_(e)){e="shift-"+e}e=e.toLowerCase();if(e.indexOf("-")!=-1){if(e.indexOf("->")==-1){e=o._normCombo(e)}}if(!n){n={}}var l=o.events[e],c={callback:t,context:n,times:i};if(!l){l=o.events[e]=[]}l.push(c)});return o};o.once=function(e,t,n){return o.on(e,t,n,1)};o.off=function(e,t,n){var i,r;if(!arguments.length){o.events={}}else{e=e?d(e):Object.keys(o.events);for(i in e){var s=e[i],a=o.events[s];if(a){var l=[];if(!n){if(!t){delete o.events[s];break}}for(r=0;r<a.length;r++){if(t){if(a[r].callback.toString()==t.toString()){if((n===null||n===undefined)&&a[r].context){l.push(a[r])}else if(!w.isEqual(a[r].context,n)){l.push(a[r])}}else{l.push(a[r])}}else if(n&&a[r].context!==n){l.push(a[r])}}if(!l.length){delete o.events[s]}else{o.events[s]=l}}}}return o};o.trigger=function(t){var n,i,r,s,a,l=[],c=w.toArray(arguments).slice(1);d(t).forEach(function(t){t=o.aliases[t]||t;o.log.debug("Triggering:",t,c.length?c:"");if(o.recording){b.push(t)}s=o.events[t];if(s){for(i=0;i<s.length;i++){a=s[i];if(a.context!==e){a.context.HIEvent=t}if(a.times){a.times-=1;if(a.times==0){o.off(t,a.callback,a.context)}}l.push(a.callback.apply(a.context||this,c))}}});return l};o.emit=o.trigger;if(typeof document.hidden!=="undefined"){document.addEventListener("visibilitychange",function(e){if(document.hidden){o.trigger("document:hidden",e)}else{o.trigger("document:visible",e)}},false)}if(o.elem===e){["resize","beforeunload","hashchange","languagechange"].forEach(function(t){e.addEventListener(t,o._genericEvent.bind(o,"window"),true)});if(e.orientation!==undefined){e.addEventListener("orientationchange",function(t){var n="window:orientation";o.trigger(n,t);if(Math.abs(e.orientation)===90){o.trigger(n+":landscape",t)}else{o.trigger(n+":portrait",t)}},false)}}o.init(o)};y.plugins=[];if(e.PointerEvent){y.defaultListenEvents=i.concat(o)}else{y.defaultListenEvents=i.concat(r)}y.noop=c;y.prototype.init=function(n){var i,o,r,f;n=n||this;if(n.events){n.trigger("hi:reset")}n.scope="";n.down=[];n.modifiers={};n.seqBuffer=[];n.touches={};n.state={};n.aliases={tap:"click",middleclick:"pointer:middle",rightclick:"pointer:right",doubleclick:"dblclick",tripleclick:Array(4).join("pointer:left ").trim(),quadrupleclick:Array(5).join("pointer:left ").trim(),konami:"up up down down left right left right b a enter",portrait:"window:orientation:portrait",landscape:"window:orientation:landscape",hulksmash:"faceplant"};n.events={};s=false;a=[];l=null;if(n.settings.disableSequences){n._handleSeqEvents=c}if(n.settings.disableSelectors){n._handleSelectors=c}if(n.elem===e){n.on("window:resize",function(){if(e.outerWidth===screen.width&&e.outerHeight===screen.height){n.state.fullscreen=true;n.trigger("fullscreen",true)}else if(n.state.fullscreen){n.state.fullscreen=false;n.trigger("fullscreen",false)}})}n.off("hi:pause");n.on("hi:pause",function(){n.log.debug(n.l("Pause: Removing event listeners"));n.settings.listenEvents.forEach(function(e){var t=n.settings.eventOptions[e]||true;if(w.isFunction(n["_"+e])){n.elem.removeEventListener(e,n["_"+e],t)}})});n.off(["hi:initialized","hi:resume"]);n.on(["hi:initialized","hi:resume"],function(){n.log.debug("HumanInput Version: "+n.VERSION);n.log.debug(n.l("Start/Resume: Addding event listeners"),n.settings.listenEvents);n.settings.listenEvents.forEach(function(e){var t=n.settings.eventOptions[e]||true;if(w.isFunction(n["_"+e])){n.elem.removeEventListener(e,n["_"+e],t);n.elem.addEventListener(e,n["_"+e],t)}else{n["_"+e]=n._genericEvent.bind(n,n.elem.name);n.elem.addEventListener(e,n["_"+e],t)}})});n.keyMaps={0:{Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,Pause:19,CapsLock:20,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,Left:37,ArrowUp:38,Up:38,ArrowRight:39,Right:39,ArrowDown:40,Down:40,PrintScreen:42,Insert:45,Delete:46,Semicolon:59,"=":61,OS:92,Select:93,NumLock:144,ScrollLock:145,VolumeDown:174,VolumeUp:175,MediaTrackPrevious:177,MediaPlayPause:179,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222,AltGraph:225,Compose:229},1:{ShiftLeft:16,ControlLeft:17,AltLeft:18,OSLeft:91},2:{ShiftRight:16,ControlRight:17,AltRight:18,OSRight:92}};if(n.settings.uniqueNumpad){n.keyMaps[3]={NumpadMultiply:106,NumpadAdd:107,NumpadSubtract:109,NumpadDecimal:46,Slash:111}}else{n.keyMaps[3]={"*":106,"+":107,"-":109,".":46,"/":111}}for(i=48;i<=57;i++){n.keyMaps[0][i]=""+(i-48)}for(i=65;i<=90;i++){n.keyMaps[0][i]=String.fromCharCode(i)}for(i=96;i<=105;i++){n.keyMaps[3][i]="Numpad"+(i-96)}for(i=112;i<=123;i++){n.keyMaps[0][i]="F"+(i-112+1)}if(t){var f,u={3:"Enter",63289:"NumpadClear",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"ArrowLeft",63232:"ArrowUp",63235:"ArrowRight",63233:"ArrowDown",63302:"Insert",63272:"Delete"};for(f in u){n.keyMaps[0][f]=u[f]}for(i=63236;i<=63242;i++){n.keyMaps[0][i]="F"+(i-63236+1)}}for(i=0;i<=3;i++){Object.keys(n.keyMaps[i]).forEach(function(e){if(e.length>1&&!isNaN(e)){e=parseInt(e)}n.keyMaps[i][n.keyMaps[i][e]]=e})}if(y.plugins.length){for(i=0;i<y.plugins.length;i++){o=new y.plugins[i](n);n.log.debug(n.l("Initializing Plugin:"),o.__name__);if(w.isFunction(o.init)){r=o.init(n);for(f in r.exports){n[f]=r.exports[f]}}}}n.trigger("hi:initialized",n)};y.prototype.logger=function(t,n){var i=this,o=function(){var t=w.toArray(arguments);t[0]=n+i.levels[level]+" "+t[0];if(w.isFunction(e.console.log)){e.console.log.apply(e.console,t)}},r=o,s=o,a=o,l=o,f=function(t){var o=Array.prototype.slice.call(arguments,1);if(n.length){o.unshift(n)}if(t==40&&i.logLevel<=40){r.apply(e.console,o)}else if(t==30&&i.logLevel<=30){s.apply(e.console,o)}else if(t==20&&i.logLevel<=20){a.apply(e.console,o)}else if(t==10&&i.logLevel<=10){l.apply(e.console,o)}};n=n||"";i.levels={40:"ERROR",30:"WARNING",20:"INFO",10:"DEBUG",ERROR:40,WARNING:30,INFO:20,DEBUG:10};if(w.isFunction(e.console.error)){r=e.console.error}if(w.isFunction(e.console.warn)){s=e.console.warn}if(w.isFunction(e.console.info)){a=e.console.info}if(w.isFunction(e.console.debug)){l=e.console.debug}i.setLevel=function(e){e=e.toUpperCase();i.error=w.partial(f,40);i.warn=w.partial(f,30);i.info=w.partial(f,20);i.debug=w.partial(f,10);i.logLevel=e;if(isNaN(e)){i.logLevel=e=i.levels[e]}if(e>40){i.error=c}if(e>30){i.warn=c}if(e>20){i.info=c}if(e>10){i.debug=c}};i.setLevel(t)};y.prototype.pushScope=function(e){if(this.scope.length){this.scope=this.scope.slice(0,-1)+"."+e+":"}else{this.scope=e+":"}};y.prototype.popScope=function(){if(this.scope.length){this.scope=this.scope.slice(0,-1).split(".").slice(0,-1).join(".")+":"}if(this.scope==":"){this.scope=""}};y.prototype.pause=function(){this.state.paused=true;this.trigger("hi:pause",this)};y.prototype.resume=function(){this.state.paused=false;this.trigger("hi:resume",this)};y.prototype._seqSlicer=function(e){var t=[],n,i,o;e=e.split(/ +(?=(?:(?:[^"]*"){2})*[^"]*$)/g);for(n=0;n<e.length-1;n++){i=e.slice(n);o=i.join(" ");if(t.indexOf(o)==-1){t.push(o)}}return t};y.prototype._sortEvents=function(e){var t=this.MODIFIERPRIORITY;e.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())});e.sort(function(e,t){return t.length-e.length});e.sort(function(e,n){e=e.toLowerCase();n=n.toLowerCase();if(e in t){if(n in t){if(t[e]>t[n]){return-1}else if(t[e]<t[n]){return 1}else{return 0}}return-1}else if(n in t){return 1}else{return 0}});return e};y.prototype._normCombo=function(e){var t=this,n,i=e.split("-"),o=i.length,r=function(e){if(e=="control"){return t.ControlKeyEvent}return e},s=function(e){for(var n=0;n<t.AltAltNames.length;n++){if(e==t.AltAltNames[n]){return t.AltKeyEvent}}return e},a=function(e){for(var n=0;n<t.AltOSNames.length;n++){if(e==t.AltOSNames[n]){return t.OSKeyEvent}}return e};for(n=0;n<o;n++){if(i[n]==""){i[n]=="-"}i[n]=i[n].toLowerCase();i[n]=r(i[n]);i[n]=s(i[n]);i[n]=a(i[n])}t._sortEvents(i);return i.join("-")};y.prototype.mouse=function(e){var t={type:e.type};if(e.type!="mousemove"&&e.type!="wheel"){if(e.button==0){t.left=true;t.buttonName="left"}else if(e.button==1){t.middle=true;t.buttonName="middle"}else if(e.button==2){t.right=true;t.buttonName="right"}else if(e.button==3){t.back=true;t.buttonName="back"}else if(e.button==4){t.forward=true;t.buttonName="forward"}else if(e.button==5){t.forward=true;t.buttonName="eraser"}else{t.buttonName=e.button}}t.button=e.button;return t};if(typeof module!=="undefined"&&module.exports){module.exports=y}if(typeof define==="function"&&define.amd){define([],function(){return y})}else if(typeof exports!=="undefined"&&exports!==null){exports.HumanInput=y}else{e.HumanInput=y}}).call(this);(function(){"use strict";var e=function(e){var t=navigator.getGamepads(),n;for(n=0;n<t.length;n++){if(t[n]&&t[n].index==e){return true}}},t=function(t){var n=this;n.__name__="GamepadPlugin";n.exports={};n.gamepads=[];n._gamepadTimer=null;n.gamepadUpdate=function(){var i,o,r,s,a,l,c,f,u,p={type:"gamepad",target:t.elem},d=t.filter(p),g=navigator.getGamepads();for(i=0;i<n.gamepads.length;i++){if(n.gamepads[i]&&!e(i)){t.trigger("gpad:disconnected",n.gamepads[i]);n.gamepads[i]=null}}for(i=0;i<g.length;++i){if(g[i]){r=g[i].index,a=n.gamepads[r];if(!a){n.log.debug("Gamepad "+r+" detected:",g[i]);t.trigger("gpad:connected",g[i]);n.gamepads[r]={axes:[],buttons:[],timestamp:g[i].timestamp,id:g[i].id};a=n.gamepads[r];for(o=0;o<g[i].buttons.length;o++){a.buttons[o]={value:0,pressed:false}}for(o=0;o<g[i].axes.length;o++){a.axes[o]=0}continue}else{if(a.timestamp==g[i].timestamp){continue}s=JSON.parse(JSON.stringify(a));a.timestamp=g[i].timestamp;a.axes=g[i].axes.slice(0);for(o=0;o<s.buttons.length;o++){a.buttons[o].pressed=g[i].buttons[o].pressed;a.buttons[o].value=g[i].buttons[o].value}}if(d){for(o=0;o<a.buttons.length;o++){l="up";if(a.buttons[o].pressed){l="down"}c="gpad:button:"+o;if(l=="down"){if(!t.isDown(c)){t._addDown(c)}}else{if(t.isDown(c)){t._handleSeqEvents();t._removeDown(c)}}if(a.buttons[o].pressed!=s.buttons[o].pressed){t.trigger(t.scope+"gpad:button:"+l,a.buttons[o].value,g[i]);t.trigger(t.scope+c+":"+l,a.buttons[o].value,g[i]);f=true}if(a.buttons[o].value!=s.buttons[o].value){t.trigger(t.scope+c+":value",a.buttons[o].value,g[i])}}for(o=0;o<s.axes.length;o++){if(a.axes[o]!=s.axes[o]){c="gpad:axis:"+o;t.trigger(t.scope+c,a.axes[o],g[i])}}if(f){t._handleDownEvents(g[i])}}}}};n.loadController=function(e){for(var n in e){t.aliases[n]=e[n]}};return n};t.prototype.init=function(e){var t=this;t.stopGamepadUpdates=function(){clearInterval(t._gamepadTimer)};t.startGamepadUpdates=function(){clearInterval(t._gamepadTimer);if(t.gamepads.length){t._gamepadTimer=setInterval(t.gamepadUpdate,e.settings.gpadInterval)}else{t._gamepadTimer=setInterval(t.gamepadUpdate,e.settings.gpadCheckInterval)}};t.log=new e.logger(e.settings.logLevel||"INFO","[HI Gamepad]");t.log.debug(e.l("Initializing Gamepad Plugin"),t);e.settings.gpadInterval=e.settings.gpadInterval||100;e.settings.gpadCheckInterval=e.settings.gpadCheckInterval||3e3;clearInterval(t._gamepadTimer);if(e.settings.listenEvents.indexOf("gamepad")!=-1){t.gamepadUpdate();t.startGamepadUpdates();e.on("document:hidden",t.stopGamepadUpdates);e.on("document:visibile",t.startGamepadUpdates);e.on("gpad:connected",t.startGamepadUpdates)}t.exports.gamepads=t.gamepads;t.exports._gamepadTimer=t._gamepadTimer;t.exports.gamepadUpdate=t.gamepadUpdate;t.exports.loadController=t.loadController;t.exports.stopGamepadUpdates=t.stopGamepadUpdates;t.exports.startGamepadUpdates=t.startGamepadUpdates;return t};HumanInput.plugins.push(t)}).call(this);(function(){"use strict";HumanInput.defaultListenEvents.push("speech");var e=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition;var t=function(e){var t=this;t.__name__="SpeechRecPlugin";t.exports={};t._rtSpeech=[];t._rtSpeechPop=function(){t._rtSpeech.reverse();t._rtSpeech.pop();t._rtSpeech.reverse()};t._rtSpeechTimer=null;t.startSpeechRec=function(){t._recognition=new webkitSpeechRecognition;t.log.debug(e.l("Starting speech recognition"),t._recognition);t._recognition.lang=e.settings.speechLang||navigator.language||"en-US";t._recognition.continuous=true;t._recognition.interimResults=true;t._recognition.onresult=function(n){var i,o="speech",r;for(i=n.resultIndex;i<n.results.length;++i){r=n.results[i][0].transcript.trim();if(n.results[i].isFinal){e._addDown(o);e._handleDownEvents(n,r);e._removeDown(o);o+=':"'+r.replace(/-/g,"–")+'"';e._addDown(o);e._handleDownEvents(n,r);e._handleSeqEvents();e._removeDown(o)}else{o+=":rt";e._addDown(o);e._handleDownEvents(n,r);e._removeDown(o);o+=':"'+r.replace(/-/g,"–")+'"';if(t._rtSpeech.indexOf(o)==-1){t._rtSpeech.push(o);e._addDown(o);e._handleDownEvents(n,r);e._removeDown(o)}}}};t._started=true;t._recognition.start()};t.stopSpeechRec=function(){t.log.debug(e.l("Stopping speech recognition"));t._recognition.stop();t._started=false};return t};t.prototype.init=function(t){var n=this;n.log=new t.logger(t.settings.logLevel||"INFO","[HI Speech]");n.log.debug(t.l("Initializing Speech Recognition Plugin"),n);t.settings.autostartSpeech=t.settings.autostartSpeech||false;if(t.settings.listenEvents.indexOf("speech")!=-1){if(e){if(t.settings.autostartSpeech){n.startSpeechRec()}t.on("document:hidden",function(){if(n._started){n.stopSpeechRec()}});t.on("document:visible",function(){if(!n._started&&t.settings.autostartSpeech){n.startSpeechRec()}})}else{n.startSpeechRec=t.noop;n.stopSpeechRec=t.noop}}n.exports.startSpeechRec=n.startSpeechRec;n.exports.stopSpeechRec=n.stopSpeechRec;return n};HumanInput.plugins.push(t)}).call(this);(function(){"use strict";navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;HumanInput.defaultListenEvents.push("clapper");var e=window.AudioContext||window.webkitAudioContext,t=60,n=function(n){var i=this;i.__name__="ClapperPlugin";i.exports={};i.startClapper=function(){var o=function(e){var o,r,s;i.stream=e;i.scriptProcessor.connect(i.context.destination);i.analyser.smoothingTimeConstant=.4;i.analyser.fftSize=128;i.streamSource=i.context.createMediaStreamSource(e);i.streamSource.connect(i.analyser);i.analyser.connect(i.scriptProcessor);i.scriptProcessor.onaudioprocess=function(){var e,a,l,c,f=Date.now();if(!o){o=f;r=f}e=f-o;a=f-r;l=f-s;if(e>t){i.analyser.getByteFrequencyData(i.freqData);if(a>=t*4&&i.freqData.filter(function(e){return e>=n.settings.clapThreshold}).length>=15){c="clap";if(a<t*8){c="doubleclap";s=f;if(l<t*12){c="applause"}}n._addDown(c);n._handleDownEvents();n._handleSeqEvents();n._removeDown(c);r=f}o=f}i.freqData=new Uint8Array(i.analyser.frequencyBinCount)}};i.context=new e;i.scriptProcessor=i.context.createScriptProcessor(1024,1,1);i.analyser=i.context.createAnalyser();i.freqData=new Uint8Array(i.analyser.frequencyBinCount);i.log.debug(n.l("Starting clap detection"));i._started=true;navigator.getUserMedia({audio:true},o,function(e){i.log.error(n.l("Could not get audio stream"),e)})};i.stopClapper=function(){i.log.debug(n.l("Stopping clap detection"));i.stream.getAudioTracks().forEach(function(e){e.stop()});i.stream.getVideoTracks().forEach(function(e){e.stop()});i.streamSource.disconnect(i.analyser);i.analyser.disconnect(i.scriptProcessor);i.scriptProcessor.disconnect(i.context.destination);i._started=false};return i};n.prototype.init=function(t){var n=this;n.log=new t.logger(t.settings.logLevel||"INFO","[HI Clapper]");n.log.debug(t.l("Initializing Clapper Plugin"),n);t.settings.autostartClapper=t.settings.autostartClapper||false;t.settings.clapThreshold=t.settings.clapThreshold||120;t.settings.autotoggleClapper=t.settings.autotoggleClapper||true;if(t.settings.listenEvents.indexOf("clapper")!=-1){if(e){if(t.settings.autostartClapper){n.startClapper()}if(t.settings.autotoggleClapper){t.on("document:hidden",function(){if(n._started){n.stopClapper()}});t.on("document:visible",function(){if(!n._started&&t.settings.autostartClapper){n.startClapper()}})}}else{n.startClapper=t.noop;n.stopClapper=t.noop}}n.exports.startClapper=n.startClapper;n.exports.stopClapper=n.stopClapper;return n};HumanInput.plugins.push(n)}).call(this);
